{
  "issue_id": 3298,
  "issue_url": "https://github.com/iBotPeaches/Apktool/issues/3298",
  "title": "[BUG] mResTable poisoned if framework is sparse",
  "description": "<h3 dir=\"auto\">Information</h3>\n<details>\n<ol dir=\"auto\">\n<li><strong>Apktool Version (<code class=\"notranslate\">apktool -version</code>)</strong> - 2.8.1 (The issue is still present after <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/iBotPeaches/Apktool/commit/54836509ed39cd54eb5b53fc627eb0dfbed5d8af/hovercard\" href=\"https://github.com/iBotPeaches/Apktool/commit/54836509ed39cd54eb5b53fc627eb0dfbed5d8af\"><tt>5483650</tt></a>)</li>\n<li><strong>APK From? (Playstore, ROM, Other)</strong> - Playstore/ ApkMirror</li>\n<li><strong>Java Version (<code class=\"notranslate\">java --version</code>)</strong> - OpenJDK 17</li>\n</ol>\n</details>\n<h3 dir=\"auto\">Stacktrace/Logcat</h3>\n<p dir=\"auto\">As <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1816993783\" data-permission-text=\"Title is private\" data-url=\"https://github.com/iBotPeaches/Apktool/issues/3199\" data-hovercard-type=\"issue\" data-hovercard-url=\"/iBotPeaches/Apktool/issues/3199/hovercard\" href=\"https://github.com/iBotPeaches/Apktool/issues/3199\">#3199</a></p>\n<h3 dir=\"auto\">Issue</h3>\n<ul dir=\"auto\">\n<li>If <code class=\"notranslate\">sparseResources</code> is set to <code class=\"notranslate\">false</code> manually in <code class=\"notranslate\">apktool.yml</code>, the app runs fine (under required modifications)</li>\n<li>I assume it is somewhat related to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1816993783\" data-permission-text=\"Title is private\" data-url=\"https://github.com/iBotPeaches/Apktool/issues/3199\" data-hovercard-type=\"issue\" data-hovercard-url=\"/iBotPeaches/Apktool/issues/3199/hovercard\" href=\"https://github.com/iBotPeaches/Apktool/issues/3199\">#3199</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1844290322\" data-permission-text=\"Title is private\" data-url=\"https://github.com/iBotPeaches/Apktool/issues/3261\" data-hovercard-type=\"issue\" data-hovercard-url=\"/iBotPeaches/Apktool/issues/3261/hovercard\" href=\"https://github.com/iBotPeaches/Apktool/issues/3261\">#3261</a></li>\n<li>In case sparsely encoded resources are not detected incorrectly, I am not entirely sure why settings <code class=\"notranslate\">sparseResources</code> to <code class=\"notranslate\">false</code> manually fixes the issue - the stacktrace above does not occur</li>\n</ul>\n<details open=\"\" class=\"details-reset border rounded-2\">\n  <summary class=\"px-3 py-2\">\n    <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-device-camera-video\">\n    <path d=\"M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z\"></path>\n</svg>\n    <span aria-label=\"Video description evidence.mp4\" class=\"m-1\">evidence.mp4</span>\n    <span class=\"dropdown-caret\"></span>\n  </summary>\n\n  <video src=\"https://private-user-images.githubusercontent.com/13122796/263542685-8ae87af8-7f04-4cad-8681-f7f7a74ddefa.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTIwODA0MjEsIm5iZiI6MTcxMjA4MDEyMSwicGF0aCI6Ii8xMzEyMjc5Ni8yNjM1NDI2ODUtOGFlODdhZjgtN2YwNC00Y2FkLTg2ODEtZjdmN2E3NGRkZWZhLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDAyVDE3NDg0MVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkzNjg3YTgxZDFmYjM2YzE1Mzk5YzVhN2E3ZDI4MmRlNWVlMzdlNGVlYjdmYTE1YjYwYTM0YTBlNmY5ODVhMzAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.eU72FtfDouQiDBw54b4V0_pzNS-YrUu2veIZ6PkfJTA\" data-canonical-src=\"https://private-user-images.githubusercontent.com/13122796/263542685-8ae87af8-7f04-4cad-8681-f7f7a74ddefa.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTIwODA0MjEsIm5iZiI6MTcxMjA4MDEyMSwicGF0aCI6Ii8xMzEyMjc5Ni8yNjM1NDI2ODUtOGFlODdhZjgtN2YwNC00Y2FkLTg2ODEtZjdmN2E3NGRkZWZhLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDAyVDE3NDg0MVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkzNjg3YTgxZDFmYjM2YzE1Mzk5YzVhN2E3ZDI4MmRlNWVlMzdlNGVlYjdmYTE1YjYwYTM0YTBlNmY5ODVhMzAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.eU72FtfDouQiDBw54b4V0_pzNS-YrUu2veIZ6PkfJTA\" controls=\"controls\" muted=\"muted\" class=\"d-block rounded-bottom-2 border-top width-fit\" style=\"max-height:640px; min-height: 200px\">\n\n  </video>\n</details>\n\n<h3 dir=\"auto\">APK</h3>\n<p dir=\"auto\"><a href=\"https://www.apkmirror.com/apk/google-inc/youtube/youtube-18-32-39-release/\" rel=\"nofollow\">https://www.apkmirror.com/apk/google-inc/youtube/youtube-18-32-39-release/</a></p>\n<h3 dir=\"auto\">Steps to Reproduce</h3>\n<p dir=\"auto\">Decode & build</p>\n<details>\n<ol dir=\"auto\">\n<li><code class=\"notranslate\">apktool d youtube-18.32.39.apk -s</code> (Notice how sparse resources are true)</li>\n<li><code class=\"notranslate\">apktool b youtube-18.32.39</code></li>\n<li>Sign/ Align & install to test (This will not work under normal circumstances with YouTube specifically)</li>\n</ol>\n</details>\n<h3 dir=\"auto\">Questions to ask before submission</h3>\n<details>\n<ol dir=\"auto\">\n<li>Have you tried <code class=\"notranslate\">apktool d</code>, <code class=\"notranslate\">apktool b</code> without changing anything? Yes</li>\n<li>If you are trying to install a modified apk, did you resign it? Yes</li>\n<li>Are you using the latest apktool version? Yes</li>\n</ol>\n</details>",
  "description_text": "Information\n\n\nApktool Version (apktool -version) - 2.8.1 (The issue is still present after 5483650)\nAPK From? (Playstore, ROM, Other) - Playstore/ ApkMirror\nJava Version (java --version) - OpenJDK 17\n\n\nStacktrace/Logcat\nAs #3199\nIssue\n\nIf sparseResources is set to false manually in apktool.yml, the app runs fine (under required modifications)\nI assume it is somewhat related to #3199 and #3261\nIn case sparsely encoded resources are not detected incorrectly, I am not entirely sure why settings sparseResources to false manually fixes the issue - the stacktrace above does not occur\n\n\n\n\n\n\nevidence.mp4\n\n\n\n\n\nAPK\nhttps://www.apkmirror.com/apk/google-inc/youtube/youtube-18-32-39-release/\nSteps to Reproduce\nDecode & build\n\n\napktool d youtube-18.32.39.apk -s (Notice how sparse resources are true)\napktool b youtube-18.32.39\nSign/ Align & install to test (This will not work under normal circumstances with YouTube specifically)\n\n\nQuestions to ask before submission\n\n\nHave you tried apktool d, apktool b without changing anything? Yes\nIf you are trying to install a modified apk, did you resign it? Yes\nAre you using the latest apktool version? Yes\n\n"
}