{
  "issue_id": 16055,
  "issue_url": "https://github.com/OpenAPITools/openapi-generator/issues/16055",
  "title": "[BUG] [JAVA] Java native client generator not working with array of files",
  "description": "<h5 dir=\"auto\">Description</h5>\n<p dir=\"auto\">Using openapi-generator-maven-plugin for generating java native client it seems generating wrong client code when API accepts an array of files.</p>\n<p dir=\"auto\">The generated client code is:</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"    ...\n    MultipartEntityBuilder multiPartBuilder = MultipartEntityBuilder.create();\n    boolean hasFiles = false;\n    for (int i=0; i < files.size(); i++) {\n        multiPartBuilder.addTextBody(\"files\", files.get(i).toString());\n    }\n    HttpEntity entity = multiPartBuilder.build();\n    HttpRequest.BodyPublisher formDataPublisher;\n    if (hasFiles) {\n    ...\"><pre class=\"notranslate\">    <span class=\"pl-s\">...</span>\n    <span class=\"pl-s\">MultipartEntityBuilder multiPartBuilder = MultipartEntityBuilder.create();</span>\n    <span class=\"pl-s\">boolean hasFiles = false;</span>\n    <span class=\"pl-s\">for (int i=0; i < files.size(); i++) {</span>\n        <span class=\"pl-s\">multiPartBuilder.addTextBody(\"files\", files.get(i).toString());</span>\n    <span class=\"pl-s\">}</span>\n    <span class=\"pl-s\">HttpEntity entity = multiPartBuilder.build();</span>\n    <span class=\"pl-s\">HttpRequest.BodyPublisher formDataPublisher;</span>\n    <span class=\"pl-s\">if (hasFiles) {</span>\n    <span class=\"pl-s\">...</span></pre></div>\n<p dir=\"auto\">I suppose that the correct client is:</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"    ...\n    MultipartEntityBuilder multiPartBuilder = MultipartEntityBuilder.create();\n    boolean hasFiles = false;\n    for (int i=0; i < files.size(); i++) {\n        multiPartBuilder.addBinaryBody(\"files\", files.get(i));\n        hasFiles = true;\n    }\n    HttpEntity entity = multiPartBuilder.build();\n    HttpRequest.BodyPublisher formDataPublisher;\n    if (hasFiles) {\n    ...\"><pre class=\"notranslate\">    <span class=\"pl-s\">...</span>\n    <span class=\"pl-s\">MultipartEntityBuilder multiPartBuilder = MultipartEntityBuilder.create();</span>\n    <span class=\"pl-s\">boolean hasFiles = false;</span>\n    <span class=\"pl-s\">for (int i=0; i < files.size(); i++) {</span>\n        <span class=\"pl-s\">multiPartBuilder.addBinaryBody(\"files\", files.get(i));</span>\n        <span class=\"pl-s\">hasFiles = true;</span>\n    <span class=\"pl-s\">}</span>\n    <span class=\"pl-s\">HttpEntity entity = multiPartBuilder.build();</span>\n    <span class=\"pl-s\">HttpRequest.BodyPublisher formDataPublisher;</span>\n    <span class=\"pl-s\">if (hasFiles) {</span>\n    <span class=\"pl-s\">...</span></pre></div>\n<h5 dir=\"auto\">openapi-generator version</h5>\n<p dir=\"auto\">Detected with v6.6.0 and v7.0.0-beta.</p>\n<h5 dir=\"auto\">Steps to reproduce</h5>\n<p dir=\"auto\">Please check this mine simple project <a href=\"https://github.com/lucar94/test-client-generator/tree/master\">https://github.com/lucar94/test-client-generator/tree/master</a></p>\n<h5 dir=\"auto\">Suggest a fix</h5>\n<p dir=\"auto\">The fix is to do in this template file <a href=\"https://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator/src/main/resources/Java/libraries/native/api.mustache#L444\">https://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator/src/main/resources/Java/libraries/native/api.mustache#L444</a></p>",
  "description_text": "Description\nUsing openapi-generator-maven-plugin for generating java native client it seems generating wrong client code when API accepts an array of files.\nThe generated client code is:\n    ...\n    MultipartEntityBuilder multiPartBuilder = MultipartEntityBuilder.create();\n    boolean hasFiles = false;\n    for (int i=0; i < files.size(); i++) {\n        multiPartBuilder.addTextBody(\"files\", files.get(i).toString());\n    }\n    HttpEntity entity = multiPartBuilder.build();\n    HttpRequest.BodyPublisher formDataPublisher;\n    if (hasFiles) {\n    ...\nI suppose that the correct client is:\n    ...\n    MultipartEntityBuilder multiPartBuilder = MultipartEntityBuilder.create();\n    boolean hasFiles = false;\n    for (int i=0; i < files.size(); i++) {\n        multiPartBuilder.addBinaryBody(\"files\", files.get(i));\n        hasFiles = true;\n    }\n    HttpEntity entity = multiPartBuilder.build();\n    HttpRequest.BodyPublisher formDataPublisher;\n    if (hasFiles) {\n    ...\nopenapi-generator version\nDetected with v6.6.0 and v7.0.0-beta.\nSteps to reproduce\nPlease check this mine simple project https://github.com/lucar94/test-client-generator/tree/master\nSuggest a fix\nThe fix is to do in this template file https://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator/src/main/resources/Java/libraries/native/api.mustache#L444"
}