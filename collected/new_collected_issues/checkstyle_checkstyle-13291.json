{
  "issue_id": 13279,
  "issue_url": "https://github.com/checkstyle/checkstyle/issues/13279",
  "title": "Record pattern causes checkstyle to fail in JDK 20 (preview)",
  "description": "<p dir=\"auto\">I have read check documentation: <a href=\"https://checkstyle.org/config_xxxxxx.html#NameOfAffectedCheck\" rel=\"nofollow\">https://checkstyle.org/config_xxxxxx.html#NameOfAffectedCheck</a><br>\nI have downloaded the latest checkstyle from: <a href=\"https://checkstyle.org/cmdline.html#Download_and_Run\" rel=\"nofollow\">https://checkstyle.org/cmdline.html#Download_and_Run</a><br>\nI have executed the cli and showed it below, as cli describes the problem better than 1,000 words</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"king@Joses-Mac-mini test % javac --enable-preview --source=20 DeconstructionBug.java\nNote: DeconstructionBug.java uses preview features of Java SE 20.\nNote: Recompile with -Xlint:preview for details.\n\nking@Joses-Mac-mini test % cat checkstyle.xml                                                                  \n<?xml version=\"1.0\"?>\n<!DOCTYPE module PUBLIC\n        \"-//Checkstyle//DTD Checkstyle Configuration 1.3//EN\"\n        \"https://checkstyle.org/dtds/configuration_1_3.dtd\">\n<module name=\"Checker\">\n        <module name=\"BeforeExecutionExclusionFileFilter\">\n                <property name=\"fileNamePattern\" value=\"module\\-info\\.java$\"/>\n        </module>\n        <module name=\"SuppressionSingleFilter\">\n                <property name=\"files\" value=\"[/\\\\]target[/\\\\]\"/>\n                <property name=\"checks\" value=\".*\"/>\n        </module>\n        <module name=\"TreeWalker\">\n                <module name=\"InvalidJavadocPosition\"/>\n                <module name=\"JavadocBlockTagLocation\"/>\n                <module name=\"JavadocContentLocationCheck\"/>\n                <module name=\"JavadocMethod\"/>\n                <module name=\"JavadocMissingLeadingAsterisk\"/>\n                <module name=\"JavadocMissingWhitespaceAfterAsterisk\"/>\n                <!--            <module name=\"JavadocParagraph\"/>-->\n                <module name=\"JavadocStyle\"/>\n                <module name=\"JavadocTagContinuationIndentation\">\n                        <property name=\"offset\" value=\"1\"/>\n                </module>\n                <module name=\"JavadocType\"/>\n                <module name=\"JavadocVariable\">\n                        <property name=\"scope\" value=\"protected\"/>\n                </module>\n                <module name=\"MissingJavadocMethod\"/>\n                <module name=\"MissingJavadocType\"/>\n                <module name=\"NonEmptyAtclauseDescription\"/>\n                <module name=\"RequireEmptyLineBeforeBlockTagGroup\"/>\n                <module name=\"SingleLineJavadoc\">\n                        <property name=\"ignoreInlineTags\" value=\"false\"/>\n                </module>\n                <!--            <module name=\"SummaryJavadocCheck\"/>-->\n                <!--            <module name=\"WriteTag\"/>-->\n        </module>\n        <!--    <module name=\"JavadocPackage\"/>-->\n</module>\n\nking@Joses-Mac-mini test % cat DeconstructionBug.java\nimport java.util.ArrayList;\nimport java.util.List;\n\npublic class DeconstructionBug\n{\n        public record InnerRecord(String a, String b)\n        {\n        }\n\n        public DeconstructionBug()\n        {\n                List<InnerRecord> aList = new ArrayList<>(1);\n                aList.add(new InnerRecord(\"a\", \"b\"));\n                for (InnerRecord(String a, String b) : aList)\n                        {\n                                System.out.println(a);\n                                System.out.println(b);\n                        }\n        }\n}\n\nking@Joses-Mac-mini test % RUN_LOCALE=\"-Duser.language=en -Duser.country=US\"\nking@Joses-Mac-mini test % java $RUN_LOCALE -jar ~/Downloads/checkstyle-10.12.0-all.jar -c checkstyle.xml DeconstructionBug.java\nStarting audit...\ncom.puppycrawl.tools.checkstyle.api.CheckstyleException: Exception was thrown while processing DeconstructionBug.java\n        at com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:306)\n        at com.puppycrawl.tools.checkstyle.Checker.process(Checker.java:223)\n        at com.puppycrawl.tools.checkstyle.Main.runCheckstyle(Main.java:415)\n        at com.puppycrawl.tools.checkstyle.Main.runCli(Main.java:338)\n        at com.puppycrawl.tools.checkstyle.Main.execute(Main.java:195)\n        at com.puppycrawl.tools.checkstyle.Main.main(Main.java:130)\nCaused by: com.puppycrawl.tools.checkstyle.api.CheckstyleException: IllegalStateException occurred while parsing file /Users/king/Projects/test/DeconstructionBug.java.\n        at com.puppycrawl.tools.checkstyle.JavaParser.parse(JavaParser.java:105)\n        at com.puppycrawl.tools.checkstyle.TreeWalker.processFiltered(TreeWalker.java:152)\n        at com.puppycrawl.tools.checkstyle.api.AbstractFileSetCheck.process(AbstractFileSetCheck.java:98)\n        at com.puppycrawl.tools.checkstyle.Checker.processFile(Checker.java:334)\n        at com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:293)\n        ... 5 more\nCaused by: java.lang.IllegalStateException: 13:11: mismatched input '(' expecting ';'\n        at com.puppycrawl.tools.checkstyle.JavaParser$CheckstyleErrorListener.syntaxError(JavaParser.java:255)\n        at org.antlr.v4.runtime.ProxyErrorListener.syntaxError(ProxyErrorListener.java:41)\n        at org.antlr.v4.runtime.Parser.notifyErrorListeners(Parser.java:544)\n        at org.antlr.v4.runtime.DefaultErrorStrategy.reportInputMismatch(DefaultErrorStrategy.java:327)\n        at org.antlr.v4.runtime.DefaultErrorStrategy.reportError(DefaultErrorStrategy.java:139)\n        at com.puppycrawl.tools.checkstyle.CheckstyleParserErrorStrategy.recoverInline(CheckstyleParserErrorStrategy.java:38)\n        at org.antlr.v4.runtime.Parser.match(Parser.java:208)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.statement(JavaLanguageParser.java:7036)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.blockStatement(JavaLanguageParser.java:6197)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.constructorBlock(JavaLanguageParser.java:5910)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.constructorDeclaration(JavaLanguageParser.java:3068)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.memberDeclaration(JavaLanguageParser.java:2758)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classBodyDeclaration(JavaLanguageParser.java:2670)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classBody(JavaLanguageParser.java:2476)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classDeclaration(JavaLanguageParser.java:1095)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.types(JavaLanguageParser.java:752)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.typeDeclaration(JavaLanguageParser.java:666)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.compilationUnit(JavaLanguageParser.java:413)\n        at com.puppycrawl.tools.checkstyle.JavaParser.parse(JavaParser.java:99)\n        ... 9 more\nCaused by: org.antlr.v4.runtime.InputMismatchException\n        ... 23 more\nCheckstyle ends with 1 errors.\"><pre class=\"notranslate\">king@Joses-Mac-mini <span class=\"pl-c1\">test</span> % javac --enable-preview --source=20 DeconstructionBug.java\nNote: DeconstructionBug.java uses preview features of Java SE 20.\nNote: Recompile with -Xlint:preview <span class=\"pl-k\">for</span> details.\n\nking@Joses-Mac-mini <span class=\"pl-c1\">test</span> % cat checkstyle.xml                                                                  \n<span class=\"pl-k\"><</span><span class=\"pl-k\">?</span>xml version=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>1.0<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">?</span><span class=\"pl-k\">></span>\n<span class=\"pl-k\"><</span><span class=\"pl-k\">!</span>DOCTYPE module PUBLIC\n        <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-//Checkstyle//DTD Checkstyle Configuration 1.3//EN<span class=\"pl-pds\">\"</span></span>\n        <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://checkstyle.org/dtds/configuration_1_3.dtd<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">></span>\n<span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Checker<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">></span>\n        <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>BeforeExecutionExclusionFileFilter<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>property name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>fileNamePattern<span class=\"pl-pds\">\"</span></span> value=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>module\\-info\\.java$<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n        <span class=\"pl-k\"><</span>/module<span class=\"pl-k\">></span>\n        <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>SuppressionSingleFilter<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>property name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>files<span class=\"pl-pds\">\"</span></span> value=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>[/<span class=\"pl-cce\">\\\\</span>]target[/<span class=\"pl-cce\">\\\\</span>]<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>property name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>checks<span class=\"pl-pds\">\"</span></span> value=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>.*<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n        <span class=\"pl-k\"><</span>/module<span class=\"pl-k\">></span>\n        <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>TreeWalker<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>InvalidJavadocPosition<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocBlockTagLocation<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocContentLocationCheck<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocMethod<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocMissingLeadingAsterisk<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocMissingWhitespaceAfterAsterisk<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span><span class=\"pl-k\">!</span>--            <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocParagraph<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>--<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocStyle<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocTagContinuationIndentation<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">></span>\n                        <span class=\"pl-k\"><</span>property name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>offset<span class=\"pl-pds\">\"</span></span> value=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>1<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>/module<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocType<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocVariable<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">></span>\n                        <span class=\"pl-k\"><</span>property name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>scope<span class=\"pl-pds\">\"</span></span> value=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>protected<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>/module<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>MissingJavadocMethod<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>MissingJavadocType<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>NonEmptyAtclauseDescription<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>RequireEmptyLineBeforeBlockTagGroup<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>SingleLineJavadoc<span class=\"pl-pds\">\"</span></span><span class=\"pl-k\">></span>\n                        <span class=\"pl-k\"><</span>property name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ignoreInlineTags<span class=\"pl-pds\">\"</span></span> value=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>false<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span>/module<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span><span class=\"pl-k\">!</span>--            <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>SummaryJavadocCheck<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>--<span class=\"pl-k\">></span>\n                <span class=\"pl-k\"><</span><span class=\"pl-k\">!</span>--            <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>WriteTag<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>--<span class=\"pl-k\">></span>\n        <span class=\"pl-k\"><</span>/module<span class=\"pl-k\">></span>\n        <span class=\"pl-k\"><</span><span class=\"pl-k\">!</span>--    <span class=\"pl-k\"><</span>module name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>JavadocPackage<span class=\"pl-pds\">\"</span></span>/<span class=\"pl-k\">></span>--<span class=\"pl-k\">></span>\n<span class=\"pl-k\"><</span>/module<span class=\"pl-k\">></span>\n\nking@Joses-Mac-mini <span class=\"pl-c1\">test</span> % cat DeconstructionBug.java\nimport java.util.ArrayList<span class=\"pl-k\">;</span>\nimport java.util.List<span class=\"pl-k\">;</span>\n\npublic class DeconstructionBug\n{\n        public record InnerRecord(String a, String b)\n        {\n        }\n\n        public <span class=\"pl-en\">DeconstructionBug</span>()\n        {\n                List<span class=\"pl-k\"><</span>InnerRecord<span class=\"pl-k\">></span> aList = new ArrayList<span class=\"pl-k\"><></span>(1)<span class=\"pl-k\">;</span>\n                aList.add(new InnerRecord(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>a<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>b<span class=\"pl-pds\">\"</span></span>))<span class=\"pl-k\">;</span>\n                <span class=\"pl-k\">for</span> (InnerRecord(String a, String b) <span class=\"pl-c1\">:</span> aList)\n                        {\n                                System.out.println(a)<span class=\"pl-k\">;</span>\n                                System.out.println(b)<span class=\"pl-k\">;</span>\n                        }\n        }\n}\n\nking@Joses-Mac-mini <span class=\"pl-c1\">test</span> % RUN_LOCALE=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-Duser.language=en -Duser.country=US<span class=\"pl-pds\">\"</span></span>\nking@Joses-Mac-mini <span class=\"pl-c1\">test</span> % java <span class=\"pl-smi\">$RUN_LOCALE</span> -jar <span class=\"pl-k\">~</span>/Downloads/checkstyle-10.12.0-all.jar -c checkstyle.xml DeconstructionBug.java\nStarting audit...\ncom.puppycrawl.tools.checkstyle.api.CheckstyleException: Exception was thrown <span class=\"pl-k\">while</span> processing DeconstructionBug.java\n        at com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:306)\n        at com.puppycrawl.tools.checkstyle.Checker.process(Checker.java:223)\n        at com.puppycrawl.tools.checkstyle.Main.runCheckstyle(Main.java:415)\n        at com.puppycrawl.tools.checkstyle.Main.runCli(Main.java:338)\n        at com.puppycrawl.tools.checkstyle.Main.execute(Main.java:195)\n        at com.puppycrawl.tools.checkstyle.Main.main(Main.java:130)\nCaused by: com.puppycrawl.tools.checkstyle.api.CheckstyleException: IllegalStateException occurred <span class=\"pl-k\">while</span> parsing file /Users/king/Projects/test/DeconstructionBug.java.\n        at com.puppycrawl.tools.checkstyle.JavaParser.parse(JavaParser.java:105)\n        at com.puppycrawl.tools.checkstyle.TreeWalker.processFiltered(TreeWalker.java:152)\n        at com.puppycrawl.tools.checkstyle.api.AbstractFileSetCheck.process(AbstractFileSetCheck.java:98)\n        at com.puppycrawl.tools.checkstyle.Checker.processFile(Checker.java:334)\n        at com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:293)\n        ... 5 more\nCaused by: java.lang.IllegalStateException: 13:11: mismatched input <span class=\"pl-s\"><span class=\"pl-pds\">'</span>(<span class=\"pl-pds\">'</span></span> expecting <span class=\"pl-s\"><span class=\"pl-pds\">'</span>;<span class=\"pl-pds\">'</span></span>\n        at com.puppycrawl.tools.checkstyle.JavaParser<span class=\"pl-smi\">$CheckstyleErrorListener</span>.syntaxError(JavaParser.java:255)\n        at org.antlr.v4.runtime.ProxyErrorListener.syntaxError(ProxyErrorListener.java:41)\n        at org.antlr.v4.runtime.Parser.notifyErrorListeners(Parser.java:544)\n        at org.antlr.v4.runtime.DefaultErrorStrategy.reportInputMismatch(DefaultErrorStrategy.java:327)\n        at org.antlr.v4.runtime.DefaultErrorStrategy.reportError(DefaultErrorStrategy.java:139)\n        at com.puppycrawl.tools.checkstyle.CheckstyleParserErrorStrategy.recoverInline(CheckstyleParserErrorStrategy.java:38)\n        at org.antlr.v4.runtime.Parser.match(Parser.java:208)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.statement(JavaLanguageParser.java:7036)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.blockStatement(JavaLanguageParser.java:6197)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.constructorBlock(JavaLanguageParser.java:5910)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.constructorDeclaration(JavaLanguageParser.java:3068)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.memberDeclaration(JavaLanguageParser.java:2758)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classBodyDeclaration(JavaLanguageParser.java:2670)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classBody(JavaLanguageParser.java:2476)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classDeclaration(JavaLanguageParser.java:1095)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.types(JavaLanguageParser.java:752)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.typeDeclaration(JavaLanguageParser.java:666)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.compilationUnit(JavaLanguageParser.java:413)\n        at com.puppycrawl.tools.checkstyle.JavaParser.parse(JavaParser.java:99)\n        ... 9 more\nCaused by: org.antlr.v4.runtime.InputMismatchException\n        ... 23 more\nCheckstyle ends with 1 errors.</pre></div>\n<hr>\n<p dir=\"auto\">Currently using a record pattern deconstruction in a <code class=\"notranslate\">for</code> loop causes checkstyle to fail. The error message from checkstyle does not indicate the line where the deconstruction is used, but several lines before it.</p>\n<p dir=\"auto\">Changing the example code from</p>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"for (InnerRecord(String a, String b) : aList)\n    {\n        System.out.println(a);\n        System.out.println(b);\n    }\"><pre class=\"notranslate\"><span class=\"pl-k\">for</span> (<span class=\"pl-en\">InnerRecord</span>(<span class=\"pl-smi\">String</span> <span class=\"pl-s1\">a</span>, <span class=\"pl-smi\">String</span> <span class=\"pl-s1\">b</span>) : <span class=\"pl-s1\">aList</span>)\n    {\n        <span class=\"pl-smi\">System</span>.<span class=\"pl-s1\">out</span>.<span class=\"pl-en\">println</span>(<span class=\"pl-s1\">a</span>);\n        <span class=\"pl-smi\">System</span>.<span class=\"pl-s1\">out</span>.<span class=\"pl-en\">println</span>(<span class=\"pl-s1\">b</span>);\n    }</pre></div>\n<p dir=\"auto\">to one without deconstruction</p>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"for (var innerRecord : aList)\n    {\n        System.out.println(innerRecord.a());\n        System.out.println(innerRecord.b());\n    }\"><pre class=\"notranslate\"><span class=\"pl-k\">for</span> (<span class=\"pl-smi\">var</span> <span class=\"pl-s1\">innerRecord</span> : <span class=\"pl-s1\">aList</span>)\n    {\n        <span class=\"pl-smi\">System</span>.<span class=\"pl-s1\">out</span>.<span class=\"pl-en\">println</span>(<span class=\"pl-s1\">innerRecord</span>.<span class=\"pl-en\">a</span>());\n        <span class=\"pl-smi\">System</span>.<span class=\"pl-s1\">out</span>.<span class=\"pl-en\">println</span>(<span class=\"pl-s1\">innerRecord</span>.<span class=\"pl-en\">b</span>());\n    }</pre></div>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"king@Joses-Mac-mini test % java $RUN_LOCALE -jar ~/Downloads/checkstyle-10.12.0-all.jar -c checkstyle.xml DeconstructionBug.java\nStarting audit...\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:4:1: Missing a Javadoc comment. [MissingJavadocType]\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:6:9: Missing a Javadoc comment. [MissingJavadocType]\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:10:9: Missing a Javadoc comment. [MissingJavadocMethod]\"><pre class=\"notranslate\">king@Joses-Mac-mini <span class=\"pl-c1\">test</span> % java <span class=\"pl-smi\">$RUN_LOCALE</span> -jar <span class=\"pl-k\">~</span>/Downloads/checkstyle-10.12.0-all.jar -c checkstyle.xml DeconstructionBug.java\nStarting audit...\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:4:1: Missing a Javadoc comment. [MissingJavadocType]\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:6:9: Missing a Javadoc comment. [MissingJavadocType]\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:10:9: Missing a Javadoc comment. [MissingJavadocMethod]</pre></div>",
  "description_text": "I have read check documentation: https://checkstyle.org/config_xxxxxx.html#NameOfAffectedCheck\nI have downloaded the latest checkstyle from: https://checkstyle.org/cmdline.html#Download_and_Run\nI have executed the cli and showed it below, as cli describes the problem better than 1,000 words\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nking@Joses-Mac-mini test % cat DeconstructionBug.java\nimport java.util.ArrayList;\nimport java.util.List;\n\npublic class DeconstructionBug\n{\n        public record InnerRecord(String a, String b)\n        {\n        }\n\n        public DeconstructionBug()\n        {\n                List aList = new ArrayList<>(1);\n                aList.add(new InnerRecord(\"a\", \"b\"));\n                for (InnerRecord(String a, String b) : aList)\n                        {\n                                System.out.println(a);\n                                System.out.println(b);\n                        }\n        }\n}\n\nking@Joses-Mac-mini test % RUN_LOCALE=\"-Duser.language=en -Duser.country=US\"\nking@Joses-Mac-mini test % java $RUN_LOCALE -jar ~/Downloads/checkstyle-10.12.0-all.jar -c checkstyle.xml DeconstructionBug.java\nStarting audit...\ncom.puppycrawl.tools.checkstyle.api.CheckstyleException: Exception was thrown while processing DeconstructionBug.java\n        at com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:306)\n        at com.puppycrawl.tools.checkstyle.Checker.process(Checker.java:223)\n        at com.puppycrawl.tools.checkstyle.Main.runCheckstyle(Main.java:415)\n        at com.puppycrawl.tools.checkstyle.Main.runCli(Main.java:338)\n        at com.puppycrawl.tools.checkstyle.Main.execute(Main.java:195)\n        at com.puppycrawl.tools.checkstyle.Main.main(Main.java:130)\nCaused by: com.puppycrawl.tools.checkstyle.api.CheckstyleException: IllegalStateException occurred while parsing file /Users/king/Projects/test/DeconstructionBug.java.\n        at com.puppycrawl.tools.checkstyle.JavaParser.parse(JavaParser.java:105)\n        at com.puppycrawl.tools.checkstyle.TreeWalker.processFiltered(TreeWalker.java:152)\n        at com.puppycrawl.tools.checkstyle.api.AbstractFileSetCheck.process(AbstractFileSetCheck.java:98)\n        at com.puppycrawl.tools.checkstyle.Checker.processFile(Checker.java:334)\n        at com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:293)\n        ... 5 more\nCaused by: java.lang.IllegalStateException: 13:11: mismatched input '(' expecting ';'\n        at com.puppycrawl.tools.checkstyle.JavaParser$CheckstyleErrorListener.syntaxError(JavaParser.java:255)\n        at org.antlr.v4.runtime.ProxyErrorListener.syntaxError(ProxyErrorListener.java:41)\n        at org.antlr.v4.runtime.Parser.notifyErrorListeners(Parser.java:544)\n        at org.antlr.v4.runtime.DefaultErrorStrategy.reportInputMismatch(DefaultErrorStrategy.java:327)\n        at org.antlr.v4.runtime.DefaultErrorStrategy.reportError(DefaultErrorStrategy.java:139)\n        at com.puppycrawl.tools.checkstyle.CheckstyleParserErrorStrategy.recoverInline(CheckstyleParserErrorStrategy.java:38)\n        at org.antlr.v4.runtime.Parser.match(Parser.java:208)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.statement(JavaLanguageParser.java:7036)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.blockStatement(JavaLanguageParser.java:6197)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.constructorBlock(JavaLanguageParser.java:5910)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.constructorDeclaration(JavaLanguageParser.java:3068)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.memberDeclaration(JavaLanguageParser.java:2758)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classBodyDeclaration(JavaLanguageParser.java:2670)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classBody(JavaLanguageParser.java:2476)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classDeclaration(JavaLanguageParser.java:1095)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.types(JavaLanguageParser.java:752)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.typeDeclaration(JavaLanguageParser.java:666)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.compilationUnit(JavaLanguageParser.java:413)\n        at com.puppycrawl.tools.checkstyle.JavaParser.parse(JavaParser.java:99)\n        ... 9 more\nCaused by: org.antlr.v4.runtime.InputMismatchException\n        ... 23 more\nCheckstyle ends with 1 errors.\">king@Joses-Mac-mini test % javac --enable-preview --source=20 DeconstructionBug.java\nNote: DeconstructionBug.java uses preview features of Java SE 20.\nNote: Recompile with -Xlint:preview for details.\n\nking@Joses-Mac-mini test % cat checkstyle.xml                                                                  \n<?xml version=\"1.0\"?>\n<!DOCTYPE module PUBLIC\n        \"-//Checkstyle//DTD Checkstyle Configuration 1.3//EN\"\n        \"https://checkstyle.org/dtds/configuration_1_3.dtd\">\n<module name=\"Checker\">\n        <module name=\"BeforeExecutionExclusionFileFilter\">\n                <property name=\"fileNamePattern\" value=\"module\\-info\\.java$\"/>\n        </module>\n        <module name=\"SuppressionSingleFilter\">\n                <property name=\"files\" value=\"[/\\\\]target[/\\\\]\"/>\n                <property name=\"checks\" value=\".*\"/>\n        </module>\n        <module name=\"TreeWalker\">\n                <module name=\"InvalidJavadocPosition\"/>\n                <module name=\"JavadocBlockTagLocation\"/>\n                <module name=\"JavadocContentLocationCheck\"/>\n                <module name=\"JavadocMethod\"/>\n                <module name=\"JavadocMissingLeadingAsterisk\"/>\n                <module name=\"JavadocMissingWhitespaceAfterAsterisk\"/>\n                <!--            <module name=\"JavadocParagraph\"/>-->\n                <module name=\"JavadocStyle\"/>\n                <module name=\"JavadocTagContinuationIndentation\">\n                        <property name=\"offset\" value=\"1\"/>\n                </module>\n                <module name=\"JavadocType\"/>\n                <module name=\"JavadocVariable\">\n                        <property name=\"scope\" value=\"protected\"/>\n                </module>\n                <module name=\"MissingJavadocMethod\"/>\n                <module name=\"MissingJavadocType\"/>\n                <module name=\"NonEmptyAtclauseDescription\"/>\n                <module name=\"RequireEmptyLineBeforeBlockTagGroup\"/>\n                <module name=\"SingleLineJavadoc\">\n                        <property name=\"ignoreInlineTags\" value=\"false\"/>\n                </module>\n                <!--            <module name=\"SummaryJavadocCheck\"/>-->\n                <!--            <module name=\"WriteTag\"/>-->\n        </module>\n        <!--    <module name=\"JavadocPackage\"/>-->\n</module>\n\nking@Joses-Mac-mini test % cat DeconstructionBug.java\nimport java.util.ArrayList;\nimport java.util.List;\n\npublic class DeconstructionBug\n{\n        public record InnerRecord(String a, String b)\n        {\n        }\n\n        public DeconstructionBug()\n        {\n                List<InnerRecord> aList = new ArrayList<>(1);\n                aList.add(new InnerRecord(\"a\", \"b\"));\n                for (InnerRecord(String a, String b) : aList)\n                        {\n                                System.out.println(a);\n                                System.out.println(b);\n                        }\n        }\n}\n\nking@Joses-Mac-mini test % RUN_LOCALE=\"-Duser.language=en -Duser.country=US\"\nking@Joses-Mac-mini test % java $RUN_LOCALE -jar ~/Downloads/checkstyle-10.12.0-all.jar -c checkstyle.xml DeconstructionBug.java\nStarting audit...\ncom.puppycrawl.tools.checkstyle.api.CheckstyleException: Exception was thrown while processing DeconstructionBug.java\n        at com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:306)\n        at com.puppycrawl.tools.checkstyle.Checker.process(Checker.java:223)\n        at com.puppycrawl.tools.checkstyle.Main.runCheckstyle(Main.java:415)\n        at com.puppycrawl.tools.checkstyle.Main.runCli(Main.java:338)\n        at com.puppycrawl.tools.checkstyle.Main.execute(Main.java:195)\n        at com.puppycrawl.tools.checkstyle.Main.main(Main.java:130)\nCaused by: com.puppycrawl.tools.checkstyle.api.CheckstyleException: IllegalStateException occurred while parsing file /Users/king/Projects/test/DeconstructionBug.java.\n        at com.puppycrawl.tools.checkstyle.JavaParser.parse(JavaParser.java:105)\n        at com.puppycrawl.tools.checkstyle.TreeWalker.processFiltered(TreeWalker.java:152)\n        at com.puppycrawl.tools.checkstyle.api.AbstractFileSetCheck.process(AbstractFileSetCheck.java:98)\n        at com.puppycrawl.tools.checkstyle.Checker.processFile(Checker.java:334)\n        at com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:293)\n        ... 5 more\nCaused by: java.lang.IllegalStateException: 13:11: mismatched input '(' expecting ';'\n        at com.puppycrawl.tools.checkstyle.JavaParser$CheckstyleErrorListener.syntaxError(JavaParser.java:255)\n        at org.antlr.v4.runtime.ProxyErrorListener.syntaxError(ProxyErrorListener.java:41)\n        at org.antlr.v4.runtime.Parser.notifyErrorListeners(Parser.java:544)\n        at org.antlr.v4.runtime.DefaultErrorStrategy.reportInputMismatch(DefaultErrorStrategy.java:327)\n        at org.antlr.v4.runtime.DefaultErrorStrategy.reportError(DefaultErrorStrategy.java:139)\n        at com.puppycrawl.tools.checkstyle.CheckstyleParserErrorStrategy.recoverInline(CheckstyleParserErrorStrategy.java:38)\n        at org.antlr.v4.runtime.Parser.match(Parser.java:208)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.statement(JavaLanguageParser.java:7036)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.blockStatement(JavaLanguageParser.java:6197)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.constructorBlock(JavaLanguageParser.java:5910)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.constructorDeclaration(JavaLanguageParser.java:3068)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.memberDeclaration(JavaLanguageParser.java:2758)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classBodyDeclaration(JavaLanguageParser.java:2670)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classBody(JavaLanguageParser.java:2476)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classDeclaration(JavaLanguageParser.java:1095)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.types(JavaLanguageParser.java:752)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.typeDeclaration(JavaLanguageParser.java:666)\n        at com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.compilationUnit(JavaLanguageParser.java:413)\n        at com.puppycrawl.tools.checkstyle.JavaParser.parse(JavaParser.java:99)\n        ... 9 more\nCaused by: org.antlr.v4.runtime.InputMismatchException\n        ... 23 more\nCheckstyle ends with 1 errors.\n\nCurrently using a record pattern deconstruction in a for loop causes checkstyle to fail. The error message from checkstyle does not indicate the line where the deconstruction is used, but several lines before it.\nChanging the example code from\nfor (InnerRecord(String a, String b) : aList)\n    {\n        System.out.println(a);\n        System.out.println(b);\n    }\nto one without deconstruction\nfor (var innerRecord : aList)\n    {\n        System.out.println(innerRecord.a());\n        System.out.println(innerRecord.b());\n    }\nking@Joses-Mac-mini test % java $RUN_LOCALE -jar ~/Downloads/checkstyle-10.12.0-all.jar -c checkstyle.xml DeconstructionBug.java\nStarting audit...\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:4:1: Missing a Javadoc comment. [MissingJavadocType]\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:6:9: Missing a Javadoc comment. [MissingJavadocType]\n[ERROR] /Users/king/Projects/test/DeconstructionBug.java:10:9: Missing a Javadoc comment. [MissingJavadocMethod]"
}