{
  "issue_id": 4327,
  "issue_url": "https://github.com/FasterXML/jackson-databind/issues/4327",
  "title": "`@JsonAlias` not respected by polymorphic deduction",
  "description": "<h3 dir=\"auto\">Search before asking</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I searched in the <a href=\"https://github.com/FasterXML/jackson-databind/issues\">issues</a> and found nothing similar.</li>\n</ul>\n<h3 dir=\"auto\">Describe the bug</h3>\n<p dir=\"auto\">I'm trying use <code class=\"notranslate\">@JsonAlias</code> on a class which is a member of a type hierarchy, and then expecting Jackson Databind to be able to use the alias to determine the type.</p>\n<p dir=\"auto\">My class hierarchy is Deduction, annotated with its two concrete implementations:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"@JsonTypeInfo(use = JsonTypeInfo.Id.DEDUCTION)\n    @JsonSubTypes({\n            @JsonSubTypes.Type(value = DeductionBean1.class),\n            @JsonSubTypes.Type(value = DeductionBean2.class)\n    })\"><pre class=\"notranslate\"><code class=\"notranslate\">@JsonTypeInfo(use = JsonTypeInfo.Id.DEDUCTION)\n    @JsonSubTypes({\n            @JsonSubTypes.Type(value = DeductionBean1.class),\n            @JsonSubTypes.Type(value = DeductionBean2.class)\n    })\n</code></pre></div>\n<p dir=\"auto\">where <code class=\"notranslate\">DeductionBean2</code> uses an alias.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"    record DeductionBean2(@JsonAlias(\"Y\") int y) implements Deduction {\n    }\"><pre class=\"notranslate\"><code class=\"notranslate\">    record DeductionBean2(@JsonAlias(\"Y\") int y) implements Deduction {\n    }\n</code></pre></div>\n<p dir=\"auto\">This fails like so when deserializing <code class=\"notranslate\">{'Y': 2 }</code></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"com.fasterxml.jackson.databind.exc.InvalidTypeIdException: Could not resolve subtype of [simple type, class com.fasterxml.jackson.databind.deser.PropertyAliasTest$Deduction]: Cannot deduce unique subtype of `com.fasterxml.jackson.databind.deser.PropertyAliasTest$Deduction` (2 candidates match)\n at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 9]\n\"><pre class=\"notranslate\"><code class=\"notranslate\">com.fasterxml.jackson.databind.exc.InvalidTypeIdException: Could not resolve subtype of [simple type, class com.fasterxml.jackson.databind.deser.PropertyAliasTest$Deduction]: Cannot deduce unique subtype of `com.fasterxml.jackson.databind.deser.PropertyAliasTest$Deduction` (2 candidates match)\n at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 9]\n\n</code></pre></div>\n<h3 dir=\"auto\">Version Information</h3>\n<p dir=\"auto\">2.17<br>\nmaster</p>\n<h3 dir=\"auto\">Reproduction</h3>\n<p dir=\"auto\">I've added a test tools.jackson.databind.deser.PropertyAliasTest#testAliasWithPolymorphicDeduction that demonstrates the issue I face.</p>\n<p dir=\"auto\"><a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/k-wall/jackson-databind/commit/8380c9437710f189aca79a47fea59f148927c7aa/hovercard\" href=\"https://github.com/k-wall/jackson-databind/commit/8380c9437710f189aca79a47fea59f148927c7aa\">k-wall@<tt>8380c94</tt></a></p>\n<h3 dir=\"auto\">Expected behavior</h3>\n<p dir=\"auto\">Aliases to be respected by <code class=\"notranslate\">DEDUCTION</code>.</p>\n<h3 dir=\"auto\">Additional context</h3>\n<p dir=\"auto\"><em>No response</em></p>",
  "description_text": "Search before asking\n\n I searched in the issues and found nothing similar.\n\nDescribe the bug\nI'm trying use @JsonAlias on a class which is a member of a type hierarchy, and then expecting Jackson Databind to be able to use the alias to determine the type.\nMy class hierarchy is Deduction, annotated with its two concrete implementations:\n@JsonTypeInfo(use = JsonTypeInfo.Id.DEDUCTION)\n    @JsonSubTypes({\n            @JsonSubTypes.Type(value = DeductionBean1.class),\n            @JsonSubTypes.Type(value = DeductionBean2.class)\n    })\n\nwhere DeductionBean2 uses an alias.\n    record DeductionBean2(@JsonAlias(\"Y\") int y) implements Deduction {\n    }\n\nThis fails like so when deserializing {'Y': 2 }\ncom.fasterxml.jackson.databind.exc.InvalidTypeIdException: Could not resolve subtype of [simple type, class com.fasterxml.jackson.databind.deser.PropertyAliasTest$Deduction]: Cannot deduce unique subtype of `com.fasterxml.jackson.databind.deser.PropertyAliasTest$Deduction` (2 candidates match)\n at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 9]\n\n\nVersion Information\n2.17\nmaster\nReproduction\nI've added a test tools.jackson.databind.deser.PropertyAliasTest#testAliasWithPolymorphicDeduction that demonstrates the issue I face.\nk-wall@8380c94\nExpected behavior\nAliases to be respected by DEDUCTION.\nAdditional context\nNo response"
}