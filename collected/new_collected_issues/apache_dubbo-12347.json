{
  "issue_id": 12334,
  "issue_url": "https://github.com/apache/dubbo/issues/12334",
  "title": "Dubbo 3.2.0 broadcast + injvm not work as expected",
  "description": "\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I have searched the <a href=\"https://github.com/apache/dubbo/issues\">issues</a> of this repository and believe that this is not a duplicate.</li>\n</ul>\n<h3 dir=\"auto\">Environment</h3>\n<ul dir=\"auto\">\n<li>Dubbo version: 3.2.0 / 3.2.1</li>\n<li>Operating System version: Windows 10</li>\n<li>Java version: OpenJDK 17.0.6</li>\n</ul>\n<h3 dir=\"auto\">Steps to reproduce this issue</h3>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"public interface RemoteCacheSyncService {\n\n  void flushCache();\n\n}\n\n@DubboService\npublic class RemoteCacheSyncServiceImpl implements RemoteCacheSyncService {\n\n  @Override\n  public void flushCache() {\n\t  // some code\t\t\t\n  }\n\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">interface</span> <span class=\"pl-smi\">RemoteCacheSyncService</span> {\n\n  <span class=\"pl-smi\">void</span> <span class=\"pl-en\">flushCache</span>();\n\n}\n\n<span class=\"pl-c1\">@</span><span class=\"pl-c1\">DubboService</span>\n<span class=\"pl-k\">public</span> <span class=\"pl-k\">class</span> <span class=\"pl-smi\">RemoteCacheSyncServiceImpl</span> <span class=\"pl-k\">implements</span> <span class=\"pl-smi\">RemoteCacheSyncService</span> {\n\n  <span class=\"pl-c1\">@</span><span class=\"pl-c1\">Override</span>\n  <span class=\"pl-k\">public</span> <span class=\"pl-smi\">void</span> <span class=\"pl-en\">flushCache</span>() {\n\t  <span class=\"pl-c\">// some code\t\t\t</span>\n  }\n\n}</pre></div>\n<p dir=\"auto\">We have 3 microservices, referred to as <code class=\"notranslate\">A</code>, <code class=\"notranslate\">B</code>, and <code class=\"notranslate\">C</code>.<br>\nEach service contains the above code.</p>\n<p dir=\"auto\">But, just <code class=\"notranslate\">C</code> has a <code class=\"notranslate\">@DubboReference</code> to the interface only.</p>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"@DubboReference(cluster = ClusterRules.BROADCAST)\nRemoteCacheSyncService remoteCacheSyncService;\"><pre class=\"notranslate\"><span class=\"pl-c1\">@</span><span class=\"pl-c1\">DubboReference</span>(<span class=\"pl-s1\">cluster</span> = <span class=\"pl-smi\">ClusterRules</span>.<span class=\"pl-c1\">BROADCAST</span>)\n<span class=\"pl-smi\">RemoteCacheSyncService</span> <span class=\"pl-s1\">remoteCacheSyncService</span>;</pre></div>\n<h3 dir=\"auto\">Expected Behavior</h3>\n<p dir=\"auto\">Call <strong>ALL</strong> implementations in <strong>ALL</strong> microservices.</p>\n<h3 dir=\"auto\">Actual Behavior</h3>\n<p dir=\"auto\">However, since there is a service implementation of the interface in the <strong>same application</strong> ( <code class=\"notranslate\">C</code> ),<br>\nDubbo will use the <code class=\"notranslate\">injvm</code> protocol. Only the service implementation located in <code class=\"notranslate\">C</code> will be invoked.</p>\n<p dir=\"auto\">Same issue with <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"731163074\" data-permission-text=\"Title is private\" data-url=\"https://github.com/apache/dubbo/issues/6842\" data-hovercard-type=\"issue\" data-hovercard-url=\"/apache/dubbo/issues/6842/hovercard\" href=\"https://github.com/apache/dubbo/issues/6842\">#6842</a> , however, it came back again.</p>",
  "description_text": "\n\n I have searched the issues of this repository and believe that this is not a duplicate.\n\nEnvironment\n\nDubbo version: 3.2.0 / 3.2.1\nOperating System version: Windows 10\nJava version: OpenJDK 17.0.6\n\nSteps to reproduce this issue\npublic interface RemoteCacheSyncService {\n\n  void flushCache();\n\n}\n\n@DubboService\npublic class RemoteCacheSyncServiceImpl implements RemoteCacheSyncService {\n\n  @Override\n  public void flushCache() {\n\t  // some code\t\t\t\n  }\n\n}\nWe have 3 microservices, referred to as A, B, and C.\nEach service contains the above code.\nBut, just C has a @DubboReference to the interface only.\n@DubboReference(cluster = ClusterRules.BROADCAST)\nRemoteCacheSyncService remoteCacheSyncService;\nExpected Behavior\nCall ALL implementations in ALL microservices.\nActual Behavior\nHowever, since there is a service implementation of the interface in the same application ( C ),\nDubbo will use the injvm protocol. Only the service implementation located in C will be invoked.\nSame issue with #6842 , however, it came back again."
}