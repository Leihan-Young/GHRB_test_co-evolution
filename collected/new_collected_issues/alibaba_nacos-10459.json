{
  "issue_id": 10361,
  "issue_url": "https://github.com/alibaba/nacos/issues/10361",
  "title": "Nacos run with only config function or naming function invalid.",
  "description": "<p dir=\"auto\"><strong>Describe the bug</strong></p>\n<p dir=\"auto\">Nacos support use <code class=\"notranslate\">-f</code> to specified which function used in old version.</p>\n<p dir=\"auto\">But from some versions(detail version is unknwon), the <code class=\"notranslate\">-f</code> seems no work.</p>\n<p dir=\"auto\"><strong>Expected behavior</strong><br>\nWhen I use <code class=\"notranslate\">-f naming</code> param to start nacos, only naming module works.</p>\n<p dir=\"auto\"><strong>Actually behavior</strong><br>\nWhen I use <code class=\"notranslate\">-f naming</code> param to start nacos, naming and config module both works.</p>\n<p dir=\"auto\"><strong>Additional context</strong></p>\n<p dir=\"auto\">Firstly, I want to use <code class=\"notranslate\">@ConditionOnXXX</code> annotation to control bean load. But I found It hard to add  <code class=\"notranslate\">@ConditionOnXXX</code> annotation to all beans in naming module and config module. What's more, I found This way also hard to control other extension module like istio module.</p>\n<p dir=\"auto\">So I want choice the <code class=\"notranslate\">@ComponentScan.Filter</code> to exclude bean scan. And in Filter to add logic judge whether the bean should be loaded.</p>\n<p dir=\"auto\">And I also found a new problem. The namespace info strongly depend config module <code class=\"notranslate\">PersistService</code> to save namespace info.<br>\nSo we need abstract persistService first, before re-open the function mode feature.</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Use <code class=\"notranslate\">@ComponentScan.Filter</code> to judge which classes and module should be loaded.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Make namespace feature not depend persistService strongly or abstract all <code class=\"notranslate\">persistService</code> to single module.</li>\n</ul>",
  "description_text": "Describe the bug\nNacos support use -f to specified which function used in old version.\nBut from some versions(detail version is unknwon), the -f seems no work.\nExpected behavior\nWhen I use -f naming param to start nacos, only naming module works.\nActually behavior\nWhen I use -f naming param to start nacos, naming and config module both works.\nAdditional context\nFirstly, I want to use @ConditionOnXXX annotation to control bean load. But I found It hard to add  @ConditionOnXXX annotation to all beans in naming module and config module. What's more, I found This way also hard to control other extension module like istio module.\nSo I want choice the @ComponentScan.Filter to exclude bean scan. And in Filter to add logic judge whether the bean should be loaded.\nAnd I also found a new problem. The namespace info strongly depend config module PersistService to save namespace info.\nSo we need abstract persistService first, before re-open the function mode feature.\n\n Use @ComponentScan.Filter to judge which classes and module should be loaded.\n Make namespace feature not depend persistService strongly or abstract all persistService to single module.\n"
}