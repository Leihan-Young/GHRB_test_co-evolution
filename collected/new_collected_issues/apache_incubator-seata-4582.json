{
  "issue_id": 4440,
  "issue_url": "https://github.com/apache/incubator-seata/issues/4440",
  "title": "transaction may not be mark as TimeoutRollbacking in time",
  "description": "<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I have searched the <a href=\"https://github.com/seata/seata/issues\">issues</a> of this repository and believe that this is not a duplicate.</li>\n</ul>\n<h3 dir=\"auto\">\u2160. Issue Description</h3>\n<p dir=\"auto\">transaction may not be mark as TimeoutRollbacking in  time.<br>\nfor example:</p>\n<p dir=\"auto\">trx1 and trx2 timeout=60s, begin=T1<br>\ntrx3 and trx4 timeout=10s, begin=T1</p>\n<p dir=\"auto\">when T1+11s, handleAllSession get transaction status= begin and  it can only read <code class=\"notranslate\">queryLimit</code>=2.<br>\ntrx1 and trx2 did not timeout, but trx3 and trx4 timedout . But it is not marked as <code class=\"notranslate\">TimeoutRollbacking</code>, because allSessions only contains trx1 and trx2.</p>\n<p dir=\"auto\">If the time when trx1 and trx2 normally end the transaction is T1 + X, trx3 and trx4 can only be marked as  <code class=\"notranslate\">TimeoutRollbacking</code> after T1 + X.</p>\n<p dir=\"auto\">If trx1 and trx2  transactions timeout, it means that trx3 and trx4 can only be marked as <code class=\"notranslate\">TimeoutRollbacking</code> after T1 + 60s.</p>\n<h3 dir=\"auto\">\u2161. Describe what happened</h3>\n<p dir=\"auto\">If there is an exception, please attach the exception trace:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Just paste your stack trace here!\"><pre class=\"notranslate\"><code class=\"notranslate\">Just paste your stack trace here!\n</code></pre></div>\n<h3 dir=\"auto\">\u2162. Describe what you expected to happen</h3>\n<h3 dir=\"auto\">\u2163. How to reproduce it (as minimally and precisely as possible)</h3>\n<ol dir=\"auto\">\n<li>xxx</li>\n<li>xxx</li>\n<li>xxx</li>\n</ol>\n<h3 dir=\"auto\">\u2164. Anything else we need to know?</h3>\n<h3 dir=\"auto\">\u2165. Environment:</h3>\n<ul dir=\"auto\">\n<li>JDK version :</li>\n<li>Seata version:</li>\n<li>OS :</li>\n<li>Others:</li>\n</ul>",
  "description_text": "\n I have searched the issues of this repository and believe that this is not a duplicate.\n\n\u2160. Issue Description\ntransaction may not be mark as TimeoutRollbacking in  time.\nfor example:\ntrx1 and trx2 timeout=60s, begin=T1\ntrx3 and trx4 timeout=10s, begin=T1\nwhen T1+11s, handleAllSession get transaction status= begin and  it can only read queryLimit=2.\ntrx1 and trx2 did not timeout, but trx3 and trx4 timedout . But it is not marked as TimeoutRollbacking, because allSessions only contains trx1 and trx2.\nIf the time when trx1 and trx2 normally end the transaction is T1 + X, trx3 and trx4 can only be marked as  TimeoutRollbacking after T1 + X.\nIf trx1 and trx2  transactions timeout, it means that trx3 and trx4 can only be marked as TimeoutRollbacking after T1 + 60s.\n\u2161. Describe what happened\nIf there is an exception, please attach the exception trace:\nJust paste your stack trace here!\n\n\u2162. Describe what you expected to happen\n\u2163. How to reproduce it (as minimally and precisely as possible)\n\nxxx\nxxx\nxxx\n\n\u2164. Anything else we need to know?\n\u2165. Environment:\n\nJDK version :\nSeata version:\nOS :\nOthers:\n"
}