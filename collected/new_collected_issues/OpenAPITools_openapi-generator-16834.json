{
  "issue_id": 10450,
  "issue_url": "https://github.com/OpenAPITools/openapi-generator/issues/10450",
  "title": "[BUG] [JAVA] oneOf generates incorrect model for primitive types",
  "description": "<h4 dir=\"auto\">Bug Report Checklist</h4>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you provided a full/minimal spec to reproduce the issue?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you validated the input using an OpenAPI validator (<a href=\"https://apidevtools.org/swagger-parser/online/\" rel=\"nofollow\">example</a>)?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you <a href=\"https://github.com/OpenAPITools/openapi-generator/wiki/FAQ#how-to-test-with-the-latest-master-of-openapi-generator\">tested with the latest master</a> to confirm the issue still exists?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you searched for related issues/PRs?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> What's the actual output vs expected output?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> [Optional] Sponsorship to speed up the bug fix or feature request (<a href=\"https://github.com/OpenAPITools/openapi-generator/issues/6178\" data-hovercard-type=\"issue\" data-hovercard-url=\"/OpenAPITools/openapi-generator/issues/6178/hovercard\">example</a>)</li>\n</ul>\n<h5 dir=\"auto\">Description</h5>\n<p dir=\"auto\">Using <code class=\"notranslate\">oneOf</code> will generate a model with incorrect wrong types.</p>\n<p dir=\"auto\"><strong>Actual output:</strong><br>\nI have three files of models: ClientIp.java, Request,java, Response.java.  Request.java has field <code class=\"notranslate\">private ClientIp clientIp = null;</code> with type ClientIp</p>\n<p dir=\"auto\"><strong>Expected output:</strong><br>\nI have only two files of models: Request,java, Response.java.  Request.java has field <code class=\"notranslate\">private String clientIp;</code> with string type</p>\n<h5 dir=\"auto\">openapi-generator version</h5>\n<p dir=\"auto\">openapi-generator-cli 5.2.1<br>\ncommit : <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/OpenAPITools/openapi-generator/commit/8403e59aa03d0099b7c6872b9b884a3d83d05b9a/hovercard\" href=\"https://github.com/OpenAPITools/openapi-generator/commit/8403e59aa03d0099b7c6872b9b884a3d83d05b9a\"><tt>8403e59</tt></a><br>\nbuilt  : 2021-08-16T12:52:51Z<br>\nsource : <a href=\"https://github.com/openapitools/openapi-generator\">https://github.com/openapitools/openapi-generator</a><br>\ndocs   : <a href=\"https://openapi-generator.tech/\" rel=\"nofollow\">https://openapi-generator.tech/</a></p>\n<p dir=\"auto\">openapi-generator-cli 5.3.0-SNAPSHOT<br>\ncommit : <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/OpenAPITools/openapi-generator/commit/de95e2a1448d125dbf8f5a286ab5bd9327fdb45c/hovercard\" href=\"https://github.com/OpenAPITools/openapi-generator/commit/de95e2a1448d125dbf8f5a286ab5bd9327fdb45c\"><tt>de95e2a</tt></a><br>\nbuilt  : 2021-09-22T15:38:29+04:00<br>\nsource : <a href=\"https://github.com/openapitools/openapi-generator\">https://github.com/openapitools/openapi-generator</a><br>\ndocs   : <a href=\"https://openapi-generator.tech/\" rel=\"nofollow\">https://openapi-generator.tech/</a></p>\n<h5 dir=\"auto\">OpenAPI declaration file content or url</h5>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"openapi: 3.0.3\n\ninfo:\n  title: java codegen BUG\n  description: oneOf generates incorrect model for primitive types\n  version: 1.0.0\n\npaths:\n  /openapi/example/path:\n    post:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/Request'\n      responses:\n        200:\n          description: OK\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Response'\n\ncomponents:\n  schemas:\n    ClientIp:\n      oneOf:\n        - type: string\n          format: ipv4\n        - type: string\n          format: ipv6\n      nullable: false\n      example: '127.0.0.1' # or '2001:0db8:85a3:0000:0000:8a2e:0370:7334' for IPv6\n\n    Response:\n      properties:\n        result:\n          type: string\n\n    Request:\n      properties:\n        result:\n          type: string\n        client_ip:\n          $ref: \"#/components/schemas/ClientIp\"\"><pre class=\"notranslate\"><span class=\"pl-ent\">openapi</span>: <span class=\"pl-s\">3.0.3</span>\n\n<span class=\"pl-ent\">info</span>:\n  <span class=\"pl-ent\">title</span>: <span class=\"pl-s\">java codegen BUG</span>\n  <span class=\"pl-ent\">description</span>: <span class=\"pl-s\">oneOf generates incorrect model for primitive types</span>\n  <span class=\"pl-ent\">version</span>: <span class=\"pl-s\">1.0.0</span>\n\n<span class=\"pl-ent\">paths</span>:\n  <span class=\"pl-ent\">/openapi/example/path</span>:\n    <span class=\"pl-ent\">post</span>:\n      <span class=\"pl-ent\">requestBody</span>:\n        <span class=\"pl-ent\">content</span>:\n          <span class=\"pl-ent\">application/json</span>:\n            <span class=\"pl-ent\">schema</span>:\n              <span class=\"pl-ent\">$ref</span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>#/components/schemas/Request<span class=\"pl-pds\">'</span></span>\n      <span class=\"pl-ent\">responses</span>:\n        <span class=\"pl-ent\">200</span>:\n          <span class=\"pl-ent\">description</span>: <span class=\"pl-s\">OK</span>\n          <span class=\"pl-ent\">content</span>:\n            <span class=\"pl-ent\">application/json</span>:\n              <span class=\"pl-ent\">schema</span>:\n                <span class=\"pl-ent\">$ref</span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>#/components/schemas/Response<span class=\"pl-pds\">'</span></span>\n\n<span class=\"pl-ent\">components</span>:\n  <span class=\"pl-ent\">schemas</span>:\n    <span class=\"pl-ent\">ClientIp</span>:\n      <span class=\"pl-ent\">oneOf</span>:\n        - <span class=\"pl-ent\">type</span>: <span class=\"pl-s\">string</span>\n          <span class=\"pl-ent\">format</span>: <span class=\"pl-s\">ipv4</span>\n        - <span class=\"pl-ent\">type</span>: <span class=\"pl-s\">string</span>\n          <span class=\"pl-ent\">format</span>: <span class=\"pl-s\">ipv6</span>\n      <span class=\"pl-ent\">nullable</span>: <span class=\"pl-c1\">false</span>\n      <span class=\"pl-ent\">example</span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>127.0.0.1<span class=\"pl-pds\">'</span></span> <span class=\"pl-c\"><span class=\"pl-c\">#</span> or '2001:0db8:85a3:0000:0000:8a2e:0370:7334' for IPv6</span>\n\n    <span class=\"pl-ent\">Response</span>:\n      <span class=\"pl-ent\">properties</span>:\n        <span class=\"pl-ent\">result</span>:\n          <span class=\"pl-ent\">type</span>: <span class=\"pl-s\">string</span>\n\n    <span class=\"pl-ent\">Request</span>:\n      <span class=\"pl-ent\">properties</span>:\n        <span class=\"pl-ent\">result</span>:\n          <span class=\"pl-ent\">type</span>: <span class=\"pl-s\">string</span>\n        <span class=\"pl-ent\">client_ip</span>:\n          <span class=\"pl-ent\">$ref</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>#/components/schemas/ClientIp<span class=\"pl-pds\">\"</span></span></pre></div>\n<h5 dir=\"auto\">Generation Details</h5>\n<p dir=\"auto\"><code class=\"notranslate\">java -jar openapi-generator-cli.jar generate -g java -i oneOfbug.yaml -o .\\gen\\</code></p>\n<h5 dir=\"auto\">Steps to reproduce</h5>\n<p dir=\"auto\">Generate a java client using the above yaml.</p>\n<h5 dir=\"auto\">Related issues/PRs</h5>\n<p dir=\"auto\">it little bit similar to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"505850217\" data-permission-text=\"Title is private\" data-url=\"https://github.com/OpenAPITools/openapi-generator/issues/4130\" data-hovercard-type=\"issue\" data-hovercard-url=\"/OpenAPITools/openapi-generator/issues/4130/hovercard\" href=\"https://github.com/OpenAPITools/openapi-generator/issues/4130\">#4130</a></p>\n<h5 dir=\"auto\">Suggest a fix</h5>\n",
  "description_text": "Bug Report Checklist\n\n Have you provided a full/minimal spec to reproduce the issue?\n Have you validated the input using an OpenAPI validator (example)?\n Have you tested with the latest master to confirm the issue still exists?\n Have you searched for related issues/PRs?\n What's the actual output vs expected output?\n [Optional] Sponsorship to speed up the bug fix or feature request (example)\n\nDescription\nUsing oneOf will generate a model with incorrect wrong types.\nActual output:\nI have three files of models: ClientIp.java, Request,java, Response.java.  Request.java has field private ClientIp clientIp = null; with type ClientIp\nExpected output:\nI have only two files of models: Request,java, Response.java.  Request.java has field private String clientIp; with string type\nopenapi-generator version\nopenapi-generator-cli 5.2.1\ncommit : 8403e59\nbuilt  : 2021-08-16T12:52:51Z\nsource : https://github.com/openapitools/openapi-generator\ndocs   : https://openapi-generator.tech/\nopenapi-generator-cli 5.3.0-SNAPSHOT\ncommit : de95e2a\nbuilt  : 2021-09-22T15:38:29+04:00\nsource : https://github.com/openapitools/openapi-generator\ndocs   : https://openapi-generator.tech/\nOpenAPI declaration file content or url\nopenapi: 3.0.3\n\ninfo:\n  title: java codegen BUG\n  description: oneOf generates incorrect model for primitive types\n  version: 1.0.0\n\npaths:\n  /openapi/example/path:\n    post:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/Request'\n      responses:\n        200:\n          description: OK\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Response'\n\ncomponents:\n  schemas:\n    ClientIp:\n      oneOf:\n        - type: string\n          format: ipv4\n        - type: string\n          format: ipv6\n      nullable: false\n      example: '127.0.0.1' # or '2001:0db8:85a3:0000:0000:8a2e:0370:7334' for IPv6\n\n    Response:\n      properties:\n        result:\n          type: string\n\n    Request:\n      properties:\n        result:\n          type: string\n        client_ip:\n          $ref: \"#/components/schemas/ClientIp\"\nGeneration Details\njava -jar openapi-generator-cli.jar generate -g java -i oneOfbug.yaml -o .\\gen\\\nSteps to reproduce\nGenerate a java client using the above yaml.\nRelated issues/PRs\nit little bit similar to #4130\nSuggest a fix\n"
}