{
  "issue_id": 369,
  "issue_url": "https://github.com/Hakky54/sslcontext-kickstart/issues/369",
  "title": "MacCertificateUtils: Invoke \"security\" without the need of a shell",
  "description": "<h2 dir=\"auto\">Summary</h2>\n<p dir=\"auto\">In <code class=\"notranslate\">MacCertificateUtils.createProcess(String)</code> (see <a href=\"https://github.com/Hakky54/sslcontext-kickstart/blob/master/sslcontext-kickstart/src/main/java/nl/altindag/ssl/util/MacCertificateUtils.java#L94-L103\">HERE</a>), in order to get the installed certificates via running the macOS-specific command <em>security</em>, a shell is spawned to handle running the command. This should not rely on a shell as an additional layer and rather invoke the command at <code class=\"notranslate\">/usr/bin/security</code> directly.</p>\n<h2 dir=\"auto\">Related problem(s)</h2>\n<p dir=\"auto\">We're using the library internally for SonarLint and we got the information that it seems to be flagged by some antivirus software as potential secret theft (maybe due to the fact that it is handled via the shell, but I cannot say so and I'm only guessing on that side, mentioned by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/nquinquenel/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/nquinquenel\">@nquinquenel</a> in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1835095305\" data-permission-text=\"Title is private\" data-url=\"https://github.com/Hakky54/sslcontext-kickstart/issues/367\" data-hovercard-type=\"issue\" data-hovercard-url=\"/Hakky54/sslcontext-kickstart/issues/367/hovercard\" href=\"https://github.com/Hakky54/sslcontext-kickstart/issues/367\">#367</a>) or at least some warning is thrown.<br>\nNevertheless, if it is connected to the issue or not, the shell layer should be avoided if possible.</p>",
  "description_text": "Summary\nIn MacCertificateUtils.createProcess(String) (see HERE), in order to get the installed certificates via running the macOS-specific command security, a shell is spawned to handle running the command. This should not rely on a shell as an additional layer and rather invoke the command at /usr/bin/security directly.\nRelated problem(s)\nWe're using the library internally for SonarLint and we got the information that it seems to be flagged by some antivirus software as potential secret theft (maybe due to the fact that it is handled via the shell, but I cannot say so and I'm only guessing on that side, mentioned by @nquinquenel in #367) or at least some warning is thrown.\nNevertheless, if it is connected to the issue or not, the shell layer should be avoided if possible."
}