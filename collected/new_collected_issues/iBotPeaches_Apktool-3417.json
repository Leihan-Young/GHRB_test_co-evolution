{
  "issue_id": 3416,
  "issue_url": "https://github.com/iBotPeaches/Apktool/issues/3416",
  "title": "[BUG] NullPointerException in serializeToResValuesXml",
  "description": "<p dir=\"auto\">Reviving issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1066474788\" data-permission-text=\"Title is private\" data-url=\"https://github.com/iBotPeaches/Apktool/issues/2709\" data-hovercard-type=\"issue\" data-hovercard-url=\"/iBotPeaches/Apktool/issues/2709/hovercard\" href=\"https://github.com/iBotPeaches/Apktool/issues/2709\">#2709</a> as I stumbled upon it with an updated app I was trying to decompile.<br>\nThe sample APK provided at the bottom of the issue is sufficient to demonstrate the issue.<br>\nUsing aapt2 dump resources you can see a problematic <code class=\"notranslate\">color</code> resource with an unexpected <code class=\"notranslate\">@null</code> value:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"...\n    resource 0x7f0601f9 color/green_f2fdf1\n      () #fff2fdf1\n    resource 0x7f0601fa color/green_highlighter_feedback\n      () #e9cbf2ce\n    resource 0x7f0601fb color/green_light_gradient\n      () #ff52cb8c\n    resource 0x7f0601fc color/green_oc831f\n      () @null\n    resource 0x7f0601fd color/grey\n      () #ffd0cecd\n    resource 0x7f0601fe color/grey_121518\n      () #ff121518\n    resource 0x7f0601ff color/grey_535353\n      () #ff9d9d9d\n...\"><pre class=\"notranslate\"><code class=\"notranslate\">...\n    resource 0x7f0601f9 color/green_f2fdf1\n      () #fff2fdf1\n    resource 0x7f0601fa color/green_highlighter_feedback\n      () #e9cbf2ce\n    resource 0x7f0601fb color/green_light_gradient\n      () #ff52cb8c\n    resource 0x7f0601fc color/green_oc831f\n      () @null\n    resource 0x7f0601fd color/grey\n      () #ffd0cecd\n    resource 0x7f0601fe color/grey_121518\n      () #ff121518\n    resource 0x7f0601ff color/grey_535353\n      () #ff9d9d9d\n...\n</code></pre></div>\n<p dir=\"auto\">From debugging how Apktool categorizes the value type, it's detected as a <code class=\"notranslate\">string</code> type rather than a <code class=\"notranslate\">reference</code>. I have no idea how this happens to begin with, but we should at least allow this to be decompiled, even as an <code class=\"notranslate\"><item></code> with a <code class=\"notranslate\">@null</code> reference (aapt2 allows to recompile that).</p>",
  "description_text": "Reviving issue #2709 as I stumbled upon it with an updated app I was trying to decompile.\nThe sample APK provided at the bottom of the issue is sufficient to demonstrate the issue.\nUsing aapt2 dump resources you can see a problematic color resource with an unexpected @null value:\n...\n    resource 0x7f0601f9 color/green_f2fdf1\n      () #fff2fdf1\n    resource 0x7f0601fa color/green_highlighter_feedback\n      () #e9cbf2ce\n    resource 0x7f0601fb color/green_light_gradient\n      () #ff52cb8c\n    resource 0x7f0601fc color/green_oc831f\n      () @null\n    resource 0x7f0601fd color/grey\n      () #ffd0cecd\n    resource 0x7f0601fe color/grey_121518\n      () #ff121518\n    resource 0x7f0601ff color/grey_535353\n      () #ff9d9d9d\n...\n\nFrom debugging how Apktool categorizes the value type, it's detected as a string type rather than a reference. I have no idea how this happens to begin with, but we should at least allow this to be decompiled, even as an  with a @null reference (aapt2 allows to recompile that)."
}