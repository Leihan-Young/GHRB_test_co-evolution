{
  "issue_id": 7531,
  "issue_url": "https://github.com/apache/rocketmq/issues/7531",
  "title": "[Bug] The PopCk is incorrect after forwarding messages to another broker",
  "description": "<h3 dir=\"auto\">Before Creating the Bug Report</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\">\n<p dir=\"auto\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I found a bug, not just asking a question, which should be created in <a href=\"https://github.com/apache/rocketmq/discussions\">GitHub Discussions</a>.</p>\n</li>\n<li class=\"task-list-item\">\n<p dir=\"auto\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I have searched the <a href=\"https://github.com/apache/rocketmq/issues\">GitHub Issues</a> and <a href=\"https://github.com/apache/rocketmq/discussions\">GitHub Discussions</a>  of this repository and believe that this is not a duplicate.</p>\n</li>\n<li class=\"task-list-item\">\n<p dir=\"auto\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I have confirmed that this bug belongs to the current repository, not other repositories of RocketMQ.</p>\n</li>\n</ul>\n<h3 dir=\"auto\">Runtime platform environment</h3>\n<p dir=\"auto\">CentOS</p>\n<h3 dir=\"auto\">RocketMQ version</h3>\n<p dir=\"auto\">develop</p>\n<h3 dir=\"auto\">JDK Version</h3>\n<p dir=\"auto\">JDK 11</p>\n<h3 dir=\"auto\">Describe the Bug</h3>\n<p dir=\"auto\">The PopCk is incorrect when consuming messages from one broker, forwarding them to another broker as is, and then consuming them from the new broker.</p>\n<h3 dir=\"auto\">Steps to Reproduce</h3>\n<ol dir=\"auto\">\n<li>Start two broker.</li>\n<li>Send messages to brokerA.</li>\n<li>Pop messages from brokerA.</li>\n<li>Forward these messages as is to broker B.</li>\n<li>Pop messages from brokerB.</li>\n<li>It will be noticed that the PopCk of the messages consumed from broker B is incorrect.</li>\n</ol>\n<h3 dir=\"auto\">What Did You Expect to See?</h3>\n<p dir=\"auto\">The correct PopCk should be used.</p>\n<h3 dir=\"auto\">What Did You See Instead?</h3>\n<p dir=\"auto\">PopCk is incorrect.</p>\n<h3 dir=\"auto\">Additional Context</h3>\n<p dir=\"auto\"><em>No response</em></p>",
  "description_text": "Before Creating the Bug Report\n\n\n I found a bug, not just asking a question, which should be created in GitHub Discussions.\n\n\n I have searched the GitHub Issues and GitHub Discussions  of this repository and believe that this is not a duplicate.\n\n\n I have confirmed that this bug belongs to the current repository, not other repositories of RocketMQ.\n\n\nRuntime platform environment\nCentOS\nRocketMQ version\ndevelop\nJDK Version\nJDK 11\nDescribe the Bug\nThe PopCk is incorrect when consuming messages from one broker, forwarding them to another broker as is, and then consuming them from the new broker.\nSteps to Reproduce\n\nStart two broker.\nSend messages to brokerA.\nPop messages from brokerA.\nForward these messages as is to broker B.\nPop messages from brokerB.\nIt will be noticed that the PopCk of the messages consumed from broker B is incorrect.\n\nWhat Did You Expect to See?\nThe correct PopCk should be used.\nWhat Did You See Instead?\nPopCk is incorrect.\nAdditional Context\nNo response"
}