{
  "issue_id": 10076,
  "issue_url": "https://github.com/apache/skywalking/issues/10076",
  "title": "[Feature] Support listeners for the `RemoteClients` change.",
  "description": "<h3 dir=\"auto\">Search before asking</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I had searched in the <a href=\"https://github.com/apache/skywalking/issues?q=is%3Aissue\">issues</a> and found no similar feature requirement.</li>\n</ul>\n<h3 dir=\"auto\">Description</h3>\n<p dir=\"auto\">In the cluster mode, OAP instances send metrics to each other according to the <code class=\"notranslate\">remote-hash code</code> to do L2 aggregation and alarm calculations for balancing\u200b. Some of the calculations leverage the previously received metrics in the memory cache and incoming metrics. So when the OAP cluster scales,  the metrics might lose their cache and impact the calculations.</p>\n<p dir=\"auto\">To avoid this situation, I think we should support listeners for the <code class=\"notranslate\">RemoteClients</code> change, then the stream workers can be notified and reload previous metrics from storage for calculation.</p>\n<h3 dir=\"auto\">Use case</h3>\n<ol dir=\"auto\">\n<li>Provide listeners' interface for notification and a registration mechanism.</li>\n<li>When the <code class=\"notranslate\">RemoteClients</code> changes, notice all listeners.</li>\n</ol>\n<h3 dir=\"auto\">Related issues</h3>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1468354532\" data-permission-text=\"Title is private\" data-url=\"https://github.com/apache/skywalking/issues/10051\" data-hovercard-type=\"issue\" data-hovercard-url=\"/apache/skywalking/issues/10051/hovercard\" href=\"https://github.com/apache/skywalking/issues/10051\">#10051</a></p>\n<h3 dir=\"auto\">Are you willing to submit a PR?</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Yes I am willing to submit a PR!</li>\n</ul>\n<h3 dir=\"auto\">Code of Conduct</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I agree to follow this project's <a href=\"https://www.apache.org/foundation/policies/conduct\" rel=\"nofollow\">Code of Conduct</a></li>\n</ul>",
  "description_text": "Search before asking\n\n I had searched in the issues and found no similar feature requirement.\n\nDescription\nIn the cluster mode, OAP instances send metrics to each other according to the remote-hash code to do L2 aggregation and alarm calculations for balancing\u200b. Some of the calculations leverage the previously received metrics in the memory cache and incoming metrics. So when the OAP cluster scales,  the metrics might lose their cache and impact the calculations.\nTo avoid this situation, I think we should support listeners for the RemoteClients change, then the stream workers can be notified and reload previous metrics from storage for calculation.\nUse case\n\nProvide listeners' interface for notification and a registration mechanism.\nWhen the RemoteClients changes, notice all listeners.\n\nRelated issues\n#10051\nAre you willing to submit a PR?\n\n Yes I am willing to submit a PR!\n\nCode of Conduct\n\n I agree to follow this project's Code of Conduct\n"
}