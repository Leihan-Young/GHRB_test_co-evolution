{
  "issue_id": 16223,
  "issue_url": "https://github.com/OpenAPITools/openapi-generator/issues/16223",
  "title": "[BUG][Spring][Array][Ref]: Array enum parameters have invalid default value",
  "description": "<h4 dir=\"auto\">Bug Report Checklist</h4>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you provided a full/minimal spec to reproduce the issue?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you validated the input using an OpenAPI validator (<a href=\"https://apidevtools.org/swagger-parser/online/\" rel=\"nofollow\">example</a>)?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you <a href=\"https://github.com/OpenAPITools/openapi-generator/wiki/FAQ#how-to-test-with-the-latest-master-of-openapi-generator\">tested with the latest master</a> to confirm the issue still exists?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you searched for related issues/PRs?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> What's the actual output vs expected output?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> [Optional] Sponsorship to speed up the bug fix or feature request (<a href=\"https://github.com/OpenAPITools/openapi-generator/issues/6178\" data-hovercard-type=\"issue\" data-hovercard-url=\"/OpenAPITools/openapi-generator/issues/6178/hovercard\">example</a>)</li>\n</ul>\n<h5 dir=\"auto\">Description</h5>\n<p dir=\"auto\">Default value tags for arrays have square braces(<code class=\"notranslate\">[]</code>) surrounded on them, which would fail because of invalid enum values.</p>\n<h5 dir=\"auto\">Initial state:</h5>\n<p dir=\"auto\"><code class=\"notranslate\">openapi.yaml</code></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"openapi: 3.0.3\ninfo:\n  version: 1.0.0\n  title: Bug Report\n  description: Spring generator, array enums\n\npaths:\n  /test:\n    $ref: 'file.yaml#/paths/~1test'\"><pre class=\"notranslate\"><code class=\"notranslate\">openapi: 3.0.3\ninfo:\n  version: 1.0.0\n  title: Bug Report\n  description: Spring generator, array enums\n\npaths:\n  /test:\n    $ref: 'file.yaml#/paths/~1test'\n</code></pre></div>\n<p dir=\"auto\"><code class=\"notranslate\">file.yaml</code></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"components:\n  parameters:\n    pets:\n      name: pets\n      in: query\n      schema:\n        type: array\n        items:\n          $ref: '#/components/schemas/Pet'\n        default: [DOG, FISH]\n\n  schemas:\n    Pet:\n      type: string\n      enum:\n        - DOG\n        - CAT\n        - FISH\n\npaths:\n  /test:\n    get:\n      description: Returns ad for a given ad ID.\n      operationId: getAd\n      parameters:\n        - $ref: '#/components/parameters/pets'\n      responses:\n        '200':\n          description: OK\n          content:\n            text/plain:\n              schema:\n                type: string\n                example: pong\n\"><pre class=\"notranslate\"><code class=\"notranslate\">components:\n  parameters:\n    pets:\n      name: pets\n      in: query\n      schema:\n        type: array\n        items:\n          $ref: '#/components/schemas/Pet'\n        default: [DOG, FISH]\n\n  schemas:\n    Pet:\n      type: string\n      enum:\n        - DOG\n        - CAT\n        - FISH\n\npaths:\n  /test:\n    get:\n      description: Returns ad for a given ad ID.\n      operationId: getAd\n      parameters:\n        - $ref: '#/components/parameters/pets'\n      responses:\n        '200':\n          description: OK\n          content:\n            text/plain:\n              schema:\n                type: string\n                example: pong\n\n</code></pre></div>\n<p dir=\"auto\">Command Run:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"openapi-generator generate -i openapi.yaml -g spring\"><pre class=\"notranslate\"><code class=\"notranslate\">openapi-generator generate -i openapi.yaml -g spring\n</code></pre></div>\n<p dir=\"auto\">Actual output:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"default ResponseEntity<String> getAd(\n        @Parameter(name = \"pets\", description = \"\", in = ParameterIn.QUERY)  @Valid\n        @RequestParam(value = \"pets\", required = false, defaultValue = \"[DOG, FISH]\") List<Pet> pets\n    )\"><pre class=\"notranslate\"><code class=\"notranslate\">default ResponseEntity<String> getAd(\n        @Parameter(name = \"pets\", description = \"\", in = ParameterIn.QUERY)  @Valid\n        @RequestParam(value = \"pets\", required = false, defaultValue = \"[DOG, FISH]\") List<Pet> pets\n    )\n</code></pre></div>\n<p dir=\"auto\">Expected Output:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"default ResponseEntity<String> getAd(\n        @Parameter(name = \"pets\", description = \"\", in = ParameterIn.QUERY)  @Valid\n        @RequestParam(value = \"pets\", required = false, defaultValue = \"DOG, FISH\") List<Pet> pets\n    )\"><pre class=\"notranslate\"><code class=\"notranslate\">default ResponseEntity<String> getAd(\n        @Parameter(name = \"pets\", description = \"\", in = ParameterIn.QUERY)  @Valid\n        @RequestParam(value = \"pets\", required = false, defaultValue = \"DOG, FISH\") List<Pet> pets\n    )\n</code></pre></div>\n<p dir=\"auto\">Actual output makes spring think that <code class=\"notranslate\">[DOG</code> and <code class=\"notranslate\">FISH]</code> are the provided enums and would fail the request processing.</p>\n<h5 dir=\"auto\">openapi-generator version</h5>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"openapi-generator-cli 6.6.0\n  commit : 7f8b853\n  built  : -999999999-01-01T00:00:00+18:00\n  source : https://github.com/openapitools/openapi-generator\n  docs   : https://openapi-generator.tech/\"><pre class=\"notranslate\"><code class=\"notranslate\">openapi-generator-cli 6.6.0\n  commit : 7f8b853\n  built  : -999999999-01-01T00:00:00+18:00\n  source : https://github.com/openapitools/openapi-generator\n  docs   : https://openapi-generator.tech/\n</code></pre></div>\n<h5 dir=\"auto\">Debug info</h5>\n<p dir=\"auto\">This bug would not occur if the paths are in the main <code class=\"notranslate\">openapi.yaml</code> file instead of being referenced from the <code class=\"notranslate\">file.yaml</code></p>",
  "description_text": "Bug Report Checklist\n\n Have you provided a full/minimal spec to reproduce the issue?\n Have you validated the input using an OpenAPI validator (example)?\n Have you tested with the latest master to confirm the issue still exists?\n Have you searched for related issues/PRs?\n What's the actual output vs expected output?\n [Optional] Sponsorship to speed up the bug fix or feature request (example)\n\nDescription\nDefault value tags for arrays have square braces([]) surrounded on them, which would fail because of invalid enum values.\nInitial state:\nopenapi.yaml\nopenapi: 3.0.3\ninfo:\n  version: 1.0.0\n  title: Bug Report\n  description: Spring generator, array enums\n\npaths:\n  /test:\n    $ref: 'file.yaml#/paths/~1test'\n\nfile.yaml\ncomponents:\n  parameters:\n    pets:\n      name: pets\n      in: query\n      schema:\n        type: array\n        items:\n          $ref: '#/components/schemas/Pet'\n        default: [DOG, FISH]\n\n  schemas:\n    Pet:\n      type: string\n      enum:\n        - DOG\n        - CAT\n        - FISH\n\npaths:\n  /test:\n    get:\n      description: Returns ad for a given ad ID.\n      operationId: getAd\n      parameters:\n        - $ref: '#/components/parameters/pets'\n      responses:\n        '200':\n          description: OK\n          content:\n            text/plain:\n              schema:\n                type: string\n                example: pong\n\n\nCommand Run:\nopenapi-generator generate -i openapi.yaml -g spring\n\nActual output:\n pets\n    )\">default ResponseEntity getAd(\n        @Parameter(name = \"pets\", description = \"\", in = ParameterIn.QUERY)  @Valid\n        @RequestParam(value = \"pets\", required = false, defaultValue = \"[DOG, FISH]\") List pets\n    )\n\nExpected Output:\n pets\n    )\">default ResponseEntity getAd(\n        @Parameter(name = \"pets\", description = \"\", in = ParameterIn.QUERY)  @Valid\n        @RequestParam(value = \"pets\", required = false, defaultValue = \"DOG, FISH\") List pets\n    )\n\nActual output makes spring think that [DOG and FISH] are the provided enums and would fail the request processing.\nopenapi-generator version\nopenapi-generator-cli 6.6.0\n  commit : 7f8b853\n  built  : -999999999-01-01T00:00:00+18:00\n  source : https://github.com/openapitools/openapi-generator\n  docs   : https://openapi-generator.tech/\n\nDebug info\nThis bug would not occur if the paths are in the main openapi.yaml file instead of being referenced from the file.yaml"
}