{
  "issue_id": 5726,
  "issue_url": "https://github.com/apache/rocketmq/issues/5726",
  "title": "there are some issue in the above verifyDelay",
  "description": "<p dir=\"auto\"></p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/apache/rocketmq/blob/81e3648e3fcb1995897db3960a4561d6047b696c/test/src/main/java/org/apache/rocketmq/test/util/VerifyUtils.java#L85-L96\">rocketmq/test/src/main/java/org/apache/rocketmq/test/util/VerifyUtils.java</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 85 to 96\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/apache/rocketmq/commit/81e3648e3fcb1995897db3960a4561d6047b696c\">81e3648</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L85\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"85\"></td>\n          <td id=\"LC85\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-smi\">boolean</span> <span class=\"pl-en\">verifyDelay</span>(<span class=\"pl-smi\">long</span> <span class=\"pl-s1\">delayTimeMills</span>, <span class=\"pl-smi\">long</span> <span class=\"pl-s1\">nextLevelDelayTimeMills</span>, </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L86\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"86\"></td>\n          <td id=\"LC86\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-smi\">Collection</span><<span class=\"pl-smi\">Object</span>> <span class=\"pl-s1\">recvMsgTimes</span>) { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L87\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"87\"></td>\n          <td id=\"LC87\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-smi\">boolean</span> <span class=\"pl-s1\">delay</span> = <span class=\"pl-c1\">true</span>; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L88\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"88\"></td>\n          <td id=\"LC88\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">for</span> (<span class=\"pl-smi\">Object</span> <span class=\"pl-s1\">timeObj</span> : <span class=\"pl-s1\">recvMsgTimes</span>) { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L89\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"89\"></td>\n          <td id=\"LC89\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">         <span class=\"pl-smi\">long</span> <span class=\"pl-s1\">time</span> = (<span class=\"pl-smi\">Long</span>) <span class=\"pl-s1\">timeObj</span>; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L90\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"90\"></td>\n          <td id=\"LC90\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">         <span class=\"pl-k\">if</span> (<span class=\"pl-s1\">time</span> < <span class=\"pl-s1\">delayTimeMills</span> || <span class=\"pl-s1\">time</span> > <span class=\"pl-s1\">nextLevelDelayTimeMills</span>) { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L91\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"91\"></td>\n          <td id=\"LC91\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">             <span class=\"pl-s1\">delay</span> = <span class=\"pl-c1\">false</span>; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L92\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"92\"></td>\n          <td id=\"LC92\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">             <span class=\"pl-s1\">logger</span>.<span class=\"pl-en\">info</span>(<span class=\"pl-smi\">String</span>.<span class=\"pl-en\">format</span>(<span class=\"pl-s\">\"delay error:%s\"</span>, <span class=\"pl-smi\">Math</span>.<span class=\"pl-en\">abs</span>(<span class=\"pl-s1\">time</span> - <span class=\"pl-s1\">delayTimeMills</span>))); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L93\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"93\"></td>\n          <td id=\"LC93\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">         } </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L94\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"94\"></td>\n          <td id=\"LC94\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     } </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L95\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"95\"></td>\n          <td id=\"LC95\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">return</span> <span class=\"pl-s1\">delay</span>; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L96\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"96\"></td>\n          <td id=\"LC96\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> } </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">there are some issue in the above verifyDelay<br>\n<a target=\"_blank\" rel=\"noopener noreferrer nofollow\" href=\"https://user-images.githubusercontent.com/105986/208237902-4059d67e-1e71-4796-bf8c-ec35be72a45e.png\"><img src=\"https://user-images.githubusercontent.com/105986/208237902-4059d67e-1e71-4796-bf8c-ec35be72a45e.png\" alt=\"image\" style=\"max-width: 100%;\"></a></p>\n<p dir=\"auto\"><em>Originally posted by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/xiaoyifang/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/xiaoyifang\">@xiaoyifang</a> in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1499926029\" data-permission-text=\"Title is private\" data-url=\"https://github.com/apache/rocketmq/issues/5720\" data-hovercard-type=\"issue\" data-hovercard-url=\"/apache/rocketmq/issues/5720/hovercard?comment_id=1356168158&comment_type=issue_comment\" href=\"https://github.com/apache/rocketmq/issues/5720#issuecomment-1356168158\">#5720 (comment)</a></em></p>",
  "description_text": "\n\n\nrocketmq/test/src/main/java/org/apache/rocketmq/test/util/VerifyUtils.java\n\n\n        Lines 85 to 96\n      in\n      81e3648\n\n\n\n\n\n\n public static boolean verifyDelay(long delayTimeMills, long nextLevelDelayTimeMills, \n\n\n\n Collection<Object> recvMsgTimes) { \n\n\n\n boolean delay = true; \n\n\n\n for (Object timeObj : recvMsgTimes) { \n\n\n\n long time = (Long) timeObj; \n\n\n\n if (time < delayTimeMills || time > nextLevelDelayTimeMills) { \n\n\n\n delay = false; \n\n\n\n logger.info(String.format(\"delay error:%s\", Math.abs(time - delayTimeMills))); \n\n\n\n         } \n\n\n\n     } \n\n\n\n return delay; \n\n\n\n } \n\n\n\n\n\nthere are some issue in the above verifyDelay\n\nOriginally posted by @xiaoyifang in #5720 (comment)"
}