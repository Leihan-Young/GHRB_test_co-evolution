{
  "issue_id": 16955,
  "issue_url": "https://github.com/OpenAPITools/openapi-generator/issues/16955",
  "title": "[BUG] Maven plugin incorrectly marks inputSpec as a required field",
  "description": "<h4 dir=\"auto\">Bug Report Checklist</h4>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you provided a full/minimal spec to reproduce the issue?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you validated the input using an OpenAPI validator (<a href=\"https://apidevtools.org/swagger-parser/online/\" rel=\"nofollow\">example</a>)?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you <a href=\"https://github.com/OpenAPITools/openapi-generator/wiki/FAQ#how-to-test-with-the-latest-master-of-openapi-generator\">tested with the latest master</a> to confirm the issue still exists?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you searched for related issues/PRs?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> What's the actual output vs expected output?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> [Optional] Sponsorship to speed up the bug fix or feature request (<a href=\"https://github.com/OpenAPITools/openapi-generator/issues/6178\" data-hovercard-type=\"issue\" data-hovercard-url=\"/OpenAPITools/openapi-generator/issues/6178/hovercard\">example</a>)</li>\n</ul>\n<h5 dir=\"auto\">Description</h5>\n<p dir=\"auto\">When using the maven plugin, I can specify an Open API Spec file using the <code class=\"notranslate\"><inputSpec>./filename.yaml</inputSpec></code> tag, or I can specify an <code class=\"notranslate\"><inputSpecRootDirectory>./directory-of-specs/</inputSpecRootDirectory></code> for it to merge the files before generating the code. When I choose the latter option, I get an error saying inputSpec is required, despite the generator ignoring the input when the inputSpecRootDirectory is specified:</p>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"        if (StringUtils.isNotBlank(inputSpecRootDirectory)) {\n            inputSpec = new MergedSpecBuilder(inputSpecRootDirectory, mergedFileName)\n                .buildMergedSpec();\n            LOGGER.info(\"Merge input spec would be used - {}\", inputSpec);\n        }\n\n        File inputSpecFile = new File(inputSpec);\"><pre class=\"notranslate\">        <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">StringUtils</span>.<span class=\"pl-en\">isNotBlank</span>(<span class=\"pl-s1\">inputSpecRootDirectory</span>)) {\n            <span class=\"pl-s1\">inputSpec</span> = <span class=\"pl-k\">new</span> <span class=\"pl-smi\">MergedSpecBuilder</span>(<span class=\"pl-s1\">inputSpecRootDirectory</span>, <span class=\"pl-s1\">mergedFileName</span>)\n                .<span class=\"pl-en\">buildMergedSpec</span>();\n            <span class=\"pl-smi\">LOGGER</span>.<span class=\"pl-en\">info</span>(<span class=\"pl-s\">\"Merge input spec would be used - {}\"</span>, <span class=\"pl-s1\">inputSpec</span>);\n        }\n\n        <span class=\"pl-smi\">File</span> <span class=\"pl-s1\">inputSpecFile</span> = <span class=\"pl-k\">new</span> <span class=\"pl-smi\">File</span>(<span class=\"pl-s1\">inputSpec</span>);</pre></div>\n<p dir=\"auto\">As such, the <code class=\"notranslate\">inputSpec</code> parameter should be optional, and validation should check that one of inputSpec or inputSpecRootDirectory is specified (perhaps with a warning if both are given)</p>\n<h5 dir=\"auto\">openapi-generator version</h5>\n<p dir=\"auto\">Latest (7.0.1)</p>\n<h5 dir=\"auto\">Maven pom.xml</h5>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"            <plugin>\n                <groupId>org.openapitools</groupId>\n                <artifactId>openapi-generator-maven-plugin</artifactId>\n                <!-- RELEASE_VERSION -->\n                <version>7.0.1</version>\n                <!-- /RELEASE_VERSION -->\n                <executions>\n                    <execution>\n                        <goals>\n                            <goal>generate</goal>\n                        </goals>\n                        <configuration>\n<!--                            <inputSpec>${project.basedir}/src/main/resources/openapi/api.yaml</inputSpec>-->\n                            <inputSpecRootDirectory>${project.basedir}/src/main/resources/openapi</inputSpecRootDirectory>\n                            <generatorName>java</generatorName>\n                            <configOptions>\n                                <sourceFolder>src/gen/java/main</sourceFolder>\n                            </configOptions>\n                            <skipValidateSpec>true</skipValidateSpec>\n                        </configuration>\n                    </execution>\n                </executions>\n            </plugin>\"><pre class=\"notranslate\">            <<span class=\"pl-s1\">plugin</span>>\n                <<span class=\"pl-s1\">groupId</span>><span class=\"pl-smi\">org</span>.<span class=\"pl-smi\">openapitools</span></<span class=\"pl-smi\">groupId</span>>\n                <<span class=\"pl-s1\">artifactId</span>><span class=\"pl-s1\">openapi</span>-<span class=\"pl-s1\">generator</span>-<span class=\"pl-s1\">maven</span>-<span class=\"pl-s1\">plugin</span></<span class=\"pl-s1\">artifactId</span>>\n                <!-- <span class=\"pl-c1\">RELEASE_VERSION</span> -->\n                <<span class=\"pl-s1\">version</span>><span class=\"pl-c1\">7.0</span>.<span class=\"pl-c1\">1</span></<span class=\"pl-smi\">version</span>>\n                <!-- /<span class=\"pl-c1\">RELEASE_VERSION</span> -->\n                <<span class=\"pl-s1\">executions</span>>\n                    <<span class=\"pl-s1\">execution</span>>\n                        <<span class=\"pl-s1\">goals</span>>\n                            <<span class=\"pl-s1\">goal</span>><span class=\"pl-s1\">generate</span></<span class=\"pl-s1\">goal</span>>\n                        </<span class=\"pl-s1\">goals</span>>\n                        <<span class=\"pl-s1\">configuration</span>>\n<!--                            <<span class=\"pl-s1\">inputSpec</span>><span class=\"pl-s1\">$</span>{<span class=\"pl-smi\">project</span>.<span class=\"pl-smi\">basedir</span>}/<span class=\"pl-s1\">src</span>/<span class=\"pl-s1\">main</span>/<span class=\"pl-s1\">resources</span>/<span class=\"pl-s1\">openapi</span>/<span class=\"pl-s1\">api</span>.<span class=\"pl-s1\">yaml</span></<span class=\"pl-s1\">inputSpec</span>>-->\n                            <<span class=\"pl-s1\">inputSpecRootDirectory</span>><span class=\"pl-s1\">$</span>{<span class=\"pl-smi\">project</span>.<span class=\"pl-smi\">basedir</span>}/<span class=\"pl-s1\">src</span>/<span class=\"pl-s1\">main</span>/<span class=\"pl-s1\">resources</span>/<span class=\"pl-s1\">openapi</span></<span class=\"pl-s1\">inputSpecRootDirectory</span>>\n                            <<span class=\"pl-s1\">generatorName</span>><span class=\"pl-s1\">java</span></<span class=\"pl-s1\">generatorName</span>>\n                            <<span class=\"pl-s1\">configOptions</span>>\n                                <<span class=\"pl-s1\">sourceFolder</span>><span class=\"pl-s1\">src</span>/<span class=\"pl-s1\">gen</span>/<span class=\"pl-s1\">java</span>/<span class=\"pl-s1\">main</span></<span class=\"pl-s1\">sourceFolder</span>>\n                            </<span class=\"pl-s1\">configOptions</span>>\n                            <<span class=\"pl-s1\">skipValidateSpec</span>><span class=\"pl-c1\">true</span></<span class=\"pl-s1\">skipValidateSpec</span>>\n                        </<span class=\"pl-s1\">configuration</span>>\n                    </<span class=\"pl-s1\">execution</span>>\n                </<span class=\"pl-s1\">executions</span>>\n            </<span class=\"pl-s1\">plugin</span>></pre></div>\n<p dir=\"auto\"><a href=\"https://github.com/fullstack-jack/openapi-generator-maven-plugin-example\">https://github.com/fullstack-jack/openapi-generator-maven-plugin-example</a></p>\n<h5 dir=\"auto\">Steps to reproduce</h5>\n<ol dir=\"auto\">\n<li>Clone example repo: <a href=\"https://github.com/fullstack-jack/openapi-generator-maven-plugin-example\">https://github.com/fullstack-jack/openapi-generator-maven-plugin-example</a></li>\n<li>Run <code class=\"notranslate\">mvn generate-sources</code> to see required field error</li>\n<li>Edit pom.xml to pass an arbitrary inputSpec e.g. <code class=\"notranslate\"><inputSpec>xxx</inputSpec></code></li>\n<li>Rerun <code class=\"notranslate\">mvn generate-sources</code> to see it create sources correctly despite useless inputSpec</li>\n</ol>\n<h5 dir=\"auto\">Related issues/PRs</h5>\n<p dir=\"auto\">none</p>\n<h5 dir=\"auto\">Suggest a fix</h5>\n<p dir=\"auto\">I might get round to creating a PR some time this week but support from anyone else is very welcome.</p>",
  "description_text": "Bug Report Checklist\n\n Have you provided a full/minimal spec to reproduce the issue?\n Have you validated the input using an OpenAPI validator (example)?\n Have you tested with the latest master to confirm the issue still exists?\n Have you searched for related issues/PRs?\n What's the actual output vs expected output?\n [Optional] Sponsorship to speed up the bug fix or feature request (example)\n\nDescription\nWhen using the maven plugin, I can specify an Open API Spec file using the ./filename.yaml tag, or I can specify an ./directory-of-specs/ for it to merge the files before generating the code. When I choose the latter option, I get an error saying inputSpec is required, despite the generator ignoring the input when the inputSpecRootDirectory is specified:\n        if (StringUtils.isNotBlank(inputSpecRootDirectory)) {\n            inputSpec = new MergedSpecBuilder(inputSpecRootDirectory, mergedFileName)\n                .buildMergedSpec();\n            LOGGER.info(\"Merge input spec would be used - {}\", inputSpec);\n        }\n\n        File inputSpecFile = new File(inputSpec);\nAs such, the inputSpec parameter should be optional, and validation should check that one of inputSpec or inputSpecRootDirectory is specified (perhaps with a warning if both are given)\nopenapi-generator version\nLatest (7.0.1)\nMaven pom.xml\n            <plugin>\n                <groupId>org.openapitoolsgroupId>\n                <artifactId>openapi-generator-maven-pluginartifactId>\n                \n                <version>7.0.1version>\n                \n                <executions>\n                    <execution>\n                        <goals>\n                            <goal>generategoal>\n                        goals>\n                        <configuration>\n\n                            <inputSpecRootDirectory>${project.basedir}/src/main/resources/openapiinputSpecRootDirectory>\n                            <generatorName>javageneratorName>\n                            <configOptions>\n                                <sourceFolder>src/gen/java/mainsourceFolder>\n                            configOptions>\n                            <skipValidateSpec>trueskipValidateSpec>\n                        configuration>\n                    execution>\n                executions>\n            plugin>\nhttps://github.com/fullstack-jack/openapi-generator-maven-plugin-example\nSteps to reproduce\n\nClone example repo: https://github.com/fullstack-jack/openapi-generator-maven-plugin-example\nRun mvn generate-sources to see required field error\nEdit pom.xml to pass an arbitrary inputSpec e.g. xxx\nRerun mvn generate-sources to see it create sources correctly despite useless inputSpec\n\nRelated issues/PRs\nnone\nSuggest a fix\nI might get round to creating a PR some time this week but support from anyone else is very welcome."
}