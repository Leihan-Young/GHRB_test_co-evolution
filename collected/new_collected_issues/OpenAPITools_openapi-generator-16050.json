{
  "issue_id": 15476,
  "issue_url": "https://github.com/OpenAPITools/openapi-generator/issues/15476",
  "title": "[BUG][python-nextgen] Cannot handle query parameters with non-ref enums",
  "description": "<h4 dir=\"auto\">Bug Report Checklist</h4>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you provided a full/minimal spec to reproduce the issue?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you validated the input using an OpenAPI validator (<a href=\"https://apidevtools.org/swagger-parser/online/\" rel=\"nofollow\">example</a>)?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you <a href=\"https://github.com/OpenAPITools/openapi-generator/wiki/FAQ#how-to-test-with-the-latest-master-of-openapi-generator\">tested with the latest master</a> to confirm the issue still exists?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Have you searched for related issues/PRs?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> What's the actual output vs expected output?</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> [Optional] Sponsorship to speed up the bug fix or feature request (<a href=\"https://github.com/OpenAPITools/openapi-generator/issues/6178\" data-hovercard-type=\"issue\" data-hovercard-url=\"/OpenAPITools/openapi-generator/issues/6178/hovercard\">example</a>)</li>\n</ul>\n\n<h5 dir=\"auto\">Description</h5>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1678110577\" data-permission-text=\"Title is private\" data-url=\"https://github.com/OpenAPITools/openapi-generator/issues/15278\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/OpenAPITools/openapi-generator/pull/15278/hovercard\" href=\"https://github.com/OpenAPITools/openapi-generator/pull/15278\">#15278</a> does not seem to work correctly.</p>\n<p dir=\"auto\">The below schema creates the function signature, one of them an enum, the other a string:</p>\n<div class=\"highlight highlight-source-python notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"query_param_with_named_enum : QueryParamEnum, query_param_without_named_enum : StrictStr\"><pre class=\"notranslate\"><span class=\"pl-s1\">query_param_with_named_enum</span> : <span class=\"pl-v\">QueryParamEnum</span>, <span class=\"pl-s1\">query_param_without_named_enum</span> : <span class=\"pl-v\">StrictStr</span></pre></div>\n<p dir=\"auto\">But still tries to access both values with <code class=\"notranslate\">.value</code>:</p>\n<div class=\"highlight highlight-source-python notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"        # process the query parameters\n        _query_params = []\n        if _params.get('query_param_with_named_enum') is not None:  # noqa: E501\n            _query_params.append(('queryParamWithNamedEnum', _params['query_param_with_named_enum'].value))\n\n        if _params.get('query_param_without_named_enum') is not None:  # noqa: E501\n            _query_params.append(('queryParamWithoutNamedEnum', _params['query_param_without_named_enum'].value))\"><pre class=\"notranslate\">        <span class=\"pl-c\"># process the query parameters</span>\n        <span class=\"pl-s1\">_query_params</span> <span class=\"pl-c1\">=</span> []\n        <span class=\"pl-k\">if</span> <span class=\"pl-s1\">_params</span>.<span class=\"pl-en\">get</span>(<span class=\"pl-s\">'query_param_with_named_enum'</span>) <span class=\"pl-c1\">is</span> <span class=\"pl-c1\">not</span> <span class=\"pl-c1\">None</span>:  <span class=\"pl-c\"># noqa: E501</span>\n            <span class=\"pl-s1\">_query_params</span>.<span class=\"pl-en\">append</span>((<span class=\"pl-s\">'queryParamWithNamedEnum'</span>, <span class=\"pl-s1\">_params</span>[<span class=\"pl-s\">'query_param_with_named_enum'</span>].<span class=\"pl-s1\">value</span>))\n\n        <span class=\"pl-k\">if</span> <span class=\"pl-s1\">_params</span>.<span class=\"pl-en\">get</span>(<span class=\"pl-s\">'query_param_without_named_enum'</span>) <span class=\"pl-c1\">is</span> <span class=\"pl-c1\">not</span> <span class=\"pl-c1\">None</span>:  <span class=\"pl-c\"># noqa: E501</span>\n            <span class=\"pl-s1\">_query_params</span>.<span class=\"pl-en\">append</span>((<span class=\"pl-s\">'queryParamWithoutNamedEnum'</span>, <span class=\"pl-s1\">_params</span>[<span class=\"pl-s\">'query_param_without_named_enum'</span>].<span class=\"pl-s1\">value</span>))</pre></div>\n<h5 dir=\"auto\">openapi-generator version</h5>\n<p dir=\"auto\">6.6.0</p>\n<h5 dir=\"auto\">OpenAPI declaration file content or url</h5>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"openapi: 3.0.1\ninfo:\n  title: \"\"\n  version: \"\"\npaths:\n  /test/endpoint:\n    get:\n      parameters:\n        - name: queryParamWithNamedEnum\n          in: query\n          required: true\n          schema:\n            $ref: '#/components/schemas/QueryParamEnum'\n        - name: queryParamWithoutNamedEnum\n          in: query\n          required: true\n          schema:\n            type: string\n            enum:\n              - ValueA\n              - ValueB\n      responses:\n        200:\n          description: OK\ncomponents:\n  schemas:\n    QueryParamEnum:\n      type: string\n      enum:\n        - ValueC\n        - ValueD\"><pre class=\"notranslate\"><span class=\"pl-ent\">openapi</span>: <span class=\"pl-s\">3.0.1</span>\n<span class=\"pl-ent\">info</span>:\n  <span class=\"pl-ent\">title</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n  <span class=\"pl-ent\">version</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n<span class=\"pl-ent\">paths</span>:\n  <span class=\"pl-ent\">/test/endpoint</span>:\n    <span class=\"pl-ent\">get</span>:\n      <span class=\"pl-ent\">parameters</span>:\n        - <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">queryParamWithNamedEnum</span>\n          <span class=\"pl-ent\">in</span>: <span class=\"pl-s\">query</span>\n          <span class=\"pl-ent\">required</span>: <span class=\"pl-c1\">true</span>\n          <span class=\"pl-ent\">schema</span>:\n            <span class=\"pl-ent\">$ref</span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>#/components/schemas/QueryParamEnum<span class=\"pl-pds\">'</span></span>\n        - <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">queryParamWithoutNamedEnum</span>\n          <span class=\"pl-ent\">in</span>: <span class=\"pl-s\">query</span>\n          <span class=\"pl-ent\">required</span>: <span class=\"pl-c1\">true</span>\n          <span class=\"pl-ent\">schema</span>:\n            <span class=\"pl-ent\">type</span>: <span class=\"pl-s\">string</span>\n            <span class=\"pl-ent\">enum</span>:\n              - <span class=\"pl-s\">ValueA</span>\n              - <span class=\"pl-s\">ValueB</span>\n      <span class=\"pl-ent\">responses</span>:\n        <span class=\"pl-ent\">200</span>:\n          <span class=\"pl-ent\">description</span>: <span class=\"pl-s\">OK</span>\n<span class=\"pl-ent\">components</span>:\n  <span class=\"pl-ent\">schemas</span>:\n    <span class=\"pl-ent\">QueryParamEnum</span>:\n      <span class=\"pl-ent\">type</span>: <span class=\"pl-s\">string</span>\n      <span class=\"pl-ent\">enum</span>:\n        - <span class=\"pl-s\">ValueC</span>\n        - <span class=\"pl-s\">ValueD</span></pre></div>\n<h5 dir=\"auto\">Related issues/PRs</h5>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1655300763\" data-permission-text=\"Title is private\" data-url=\"https://github.com/OpenAPITools/openapi-generator/issues/15133\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/OpenAPITools/openapi-generator/pull/15133/hovercard\" href=\"https://github.com/OpenAPITools/openapi-generator/pull/15133\">#15133</a><br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1678110577\" data-permission-text=\"Title is private\" data-url=\"https://github.com/OpenAPITools/openapi-generator/issues/15278\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/OpenAPITools/openapi-generator/pull/15278/hovercard\" href=\"https://github.com/OpenAPITools/openapi-generator/pull/15278\">#15278</a></p>\n<h5 dir=\"auto\">Suggest a fix</h5>\n<p dir=\"auto\">Short-term: Do not use <code class=\"notranslate\">.value</code> on raw string.</p>\n<p dir=\"auto\">Long-term: Restrict the allowed values for non-ref enums somehow, maybe with a custom model or the <a href=\"https://docs.pydantic.dev/latest/usage/types/#literal-type\" rel=\"nofollow\">literal type</a>. This might be breaking for some users.</p>",
  "description_text": "Bug Report Checklist\n\n Have you provided a full/minimal spec to reproduce the issue?\n Have you validated the input using an OpenAPI validator (example)?\n Have you tested with the latest master to confirm the issue still exists?\n Have you searched for related issues/PRs?\n What's the actual output vs expected output?\n [Optional] Sponsorship to speed up the bug fix or feature request (example)\n\nDescription\n#15278 does not seem to work correctly.\nThe below schema creates the function signature, one of them an enum, the other a string:\nquery_param_with_named_enum : QueryParamEnum, query_param_without_named_enum : StrictStr\nBut still tries to access both values with .value:\n        # process the query parameters\n        _query_params = []\n        if _params.get('query_param_with_named_enum') is not None:  # noqa: E501\n            _query_params.append(('queryParamWithNamedEnum', _params['query_param_with_named_enum'].value))\n\n        if _params.get('query_param_without_named_enum') is not None:  # noqa: E501\n            _query_params.append(('queryParamWithoutNamedEnum', _params['query_param_without_named_enum'].value))\nopenapi-generator version\n6.6.0\nOpenAPI declaration file content or url\nopenapi: 3.0.1\ninfo:\n  title: \"\"\n  version: \"\"\npaths:\n  /test/endpoint:\n    get:\n      parameters:\n        - name: queryParamWithNamedEnum\n          in: query\n          required: true\n          schema:\n            $ref: '#/components/schemas/QueryParamEnum'\n        - name: queryParamWithoutNamedEnum\n          in: query\n          required: true\n          schema:\n            type: string\n            enum:\n              - ValueA\n              - ValueB\n      responses:\n        200:\n          description: OK\ncomponents:\n  schemas:\n    QueryParamEnum:\n      type: string\n      enum:\n        - ValueC\n        - ValueD\nRelated issues/PRs\n#15133\n#15278\nSuggest a fix\nShort-term: Do not use .value on raw string.\nLong-term: Restrict the allowed values for non-ref enums somehow, maybe with a custom model or the literal type. This might be breaking for some users."
}